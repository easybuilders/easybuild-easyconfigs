easyblock = 'PythonBundle'

name = 'EVcouplings'
version = '0.2.1'

homepage = 'https://github.com/debbiemarkslab/EVcouplings'
description = "Predict protein structure, function and mutations using evolutionary sequence covariation."
github_account = 'debbiemarkslab'

toolchain = {'name': 'foss', 'version': '2024a'}

builddependencies = [
    ('hatchling', '1.24.2'),
]

dependencies = [
    ('Python', '3.12.3'),
    ('SciPy-bundle', '2024.05'),
    ('numba', '0.60.0'),
    ('ruamel.yaml', '0.18.6'),
    ('matplotlib', '3.9.2'),
    ('bokeh', '3.6.0'),
    ('Biopython', '1.84'),
    ('Seaborn', '0.13.2'),
    ('scikit-learn', '1.5.2'),
    ('HMMER', '3.4'),
    # Needs plmc installed with single precision
    ('plmc', '20230121', '-32bit'),
]

exts_list = [
    ('mmtf-python', '1.1.3', {
        'modulename': 'mmtf',
        'checksums': ['12a02fe1b7131f0a2b8ce45b46f1e0cdd28b9818fe4499554c26884987ea0c32'],
    }),
    ('billiard', '4.2.4', {
        'checksums': ['55f542c371209e03cd5862299b74e52e4fbcba8250ba611ad94276b369b6a85f'],
    }),
    ('evcouplings', version, {
        'source_urls': [GITHUB_SOURCE],
        'sources': ['v%(version)s.tar.gz'],
        'checksums': ['7ff44cdbc14b7319ceef5fa50801edf78aea4892bec04475517763a6d46bd058'],
        # relax version requirement on ruamel.yaml
        'preinstallopts': "sed -i 's/ruamel.yaml<0.18/ruamel.yaml/' pyproject.toml &&",
    }),
]

modextrapaths = {
    'EVCOUPLINGS_RUNCFG_APP': 'bin/evcouplings_runcfg',
    'EVCOUPLINGS_SUMMARIZE_APP': 'bin/evcouplings_summarize',
}

sanity_check_commands = [
    "evcouplings --help",
]

moduleclass = 'bio'
