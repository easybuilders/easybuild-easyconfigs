easyblock = 'PythonBundle'

name = 'CUDA-wheel-bundle'
version = '12.8.0'
versionsuffix = '-CUDA-%(cudaver)s'

homepage = 'https://developer.nvidia.com/cuda'
description = "Repackaging of NVIDIA CUDA libraries as Python packages"

toolchain = {'name': 'gompi', 'version': '2025a'}

dependencies = [
    ('CUDA', '12.8.0', '', SYSTEM),
    ('cuDNN', '9.10.1.4', versionsuffix, SYSTEM),
    ('cuSPARSELt', '0.8.0.4', versionsuffix, SYSTEM),
    ('NCCL', '2.27.7', versionsuffix),
    ('NVSHMEM', '3.3.20', versionsuffix),
    ('Python', '3.13.1'),
]

dummy_package = True

# the following package list is based on the requirements of PyTorch 2.9.1
exts_list = [
    # provided by CUDA
    ('nvidia-cublas-cu12', '12.8.4.1'),
    ('nvidia-cuda-cupti-cu12', '12.8.90'),
    ('nvidia-cuda-nvrtc-cu12', '12.8.93'),
    ('nvidia-cuda-runtime-cu12', '12.8.90'),
    ('nvidia-cufft-cu12', '11.3.3.83'),
    ('nvidia-cufile-cu12', '1.13.1.3'),
    ('nvidia-curand-cu12', '10.3.9.90'),
    ('nvidia-cusolver-cu12', '11.7.3.90'),
    ('nvidia-cusparse-cu12', '12.5.8.93'),
    ('nvidia-nvjitlink-cu12', '12.8.93'),
    ('nvidia-nvtx-cu12', '12.8.90'),
    # provided by cuDNN
    ('nvidia-cudnn-cu12', '9.10.2.21'),
    # provided by cuSPARSELt
    ('nvidia-cusparselt-cu12', '0.7.1'),
    # provided by NCCL
    ('nvidia-nccl-cu12', '2.27.5'),
    # provided by NVSHMEM
    ('nvidia-nvshmem-cu12', '3.3.20'),
]

moduleclass = 'lib'
