name = 'Clang'
version = '18.1.8'

homepage = 'https://clang.llvm.org/'
description = """C, C++, Objective-C compiler, based on LLVM.  Does not
 include C++ standard library -- use libstdc++ from GCC."""

# Clang also depends on libstdc++ during runtime, but this dependency is
# already specified as the toolchain.
toolchain = {'name': 'GCCcore', 'version': '13.3.0'}
# workaround for bootstrapped clang not finding ffi headers
toolchainopts = {'extra_cxxflags': '-I${EBROOTGENTOO}/lib64/libffi/include'}

source_urls = ["https://github.com/llvm/llvm-project/releases/download/llvmorg-%(version)s"]
sources = [
    'llvm-project-%(version)s.src.tar.xz',
]
checksums = ['0b58557a6d32ceee97c8d533a59b9212d87e0fc4d2833924eb6c611247db2f2a']

builddependencies = [
    ('CMake', '3.27.7'),
    ('Perl', '5.38.2'),
    ('SWIG', '4.2.1'),
]
dependencies = [
    # since Clang is a compiler, binutils is a runtime dependency too
    ('binutils', '2.40'),
    ('hwloc', '2.9.1'),
    ('libxml2', '2.11.4'),
    ('ncurses', '6.4'),
    ('GMP', '6.3.0'),
    ('Z3', '4.13.0'),
]

multi_deps = { 'Python': ['3.10', '3.11', '3.12', '3.13'] }
modextrapaths = {"EBPYTHONPREFIXES": ""}

# we can enable RTTI with Flang, just not exception handling
configopts = "-DLLVM_ENABLE_RTTI=ON"

# If True, Flang does not currently support building with LLVM exceptions enabled.
enable_rtti = False

assertions = True
python_bindings = True
skip_all_tests = True

llvm_runtimes = ['libunwind', 'libcxx', 'libcxxabi']
llvm_projects = ['polly', 'lld', 'lldb', 'clang-tools-extra', 'flang']

moduleclass = 'compiler'
