# This easyconfig was created by the BEAR Software team at the University of Birmingham.
easyblock = 'PythonBundle'

name = 'CellBender'
version = '0.2.0'
versionsuffix = '-CUDA-%(cudaver)s'

homepage = "https://cellbender.rtfd.io/"
description = """CellBender is a software package for eliminating technical artifacts from high-throughput single-cell
 RNA sequencing (scRNA-seq) data. """

toolchain = {'name': 'foss', 'version': '2021a'}

dependencies = [
    ('CUDA', '11.3.1', '', True),
    ('Python', '3.9.5'),
    ('PyTables', '3.6.1'),
    ('PyTorch', '1.10.0', versionsuffix),
    ('h5py', '3.2.1'),
    ('matplotlib', '3.4.2'),
    ('scikit-learn', '0.24.2'),
    ('tqdm', '4.61.2'),
]

sanity_pip_check = True
use_pip = True

exts_list = [
    ('opt_einsum', '3.3.0', {
        'checksums': ['59f6475f77bbc37dcf7cd748519c0ec60722e91e63ca114e68821c0c54a46549'],
    }),
    ('pyro-api', '0.1.2', {
        'modulename': 'pyroapi',
        'checksums': ['a1b900d9580aa1c2fab3b123ab7ff33413744da7c5f440bd4aadc4d40d14d920'],
    }),
    ('pyro-ppl', '1.7.0', {
        'modulename': 'pyro',
        'checksums': ['a8ec6968fdfa34f140584b266099238f1ffeacbbaab3775de5c94c0e685d018a'],
    }),
    ('sphinx-argparse', '0.3.1', {
        'modulename': 'sphinxarg',
        'checksums': ['82151cbd43ccec94a1530155f4ad34f251aaca6a0ffd5516d7fadf952d32dc1e'],
    }),
    ('sphinx_autodoc_typehints', '1.15.1', {
        'checksums': ['47bd87c2d99173e20c44d5604917ff890bb2d2e77174d952b061dcfaa99f0b7d'],
    }),
    ('sphinx_rtd_theme', '1.0.0', {
        'checksums': ['eec6d497e4c2195fa0e8b2016b337532b8a699a68bcb22a512870e16925c6a5c'],
    }),
    ('sphinxcontrib-programoutput', '0.17', {
        'modulename': False,
        'checksums': ['300ee9b8caee8355d25cc74b4d1c7efd12e608d2ad165e3141d31e6fbc152b7f'],
    }),
    ('natsort', '8.1.0', {
        'checksums': ['c7c1f3f27c375719a4dfcab353909fe39f26c2032a062a8c80cc844eaaca0445'],
    }),
    ('anndata', '0.8.0', {
        'checksums': ['94d2cc6f76c0317c0ac28564e3092b313b7ad19c737d66701961f3e620b9066e'],
    }),
    (name, version, {
        'source_tmpl': 'v%(version)s.tar.gz',
        'source_urls': ['https://github.com/broadinstitute/CellBender/archive/'],
        'preinstallopts': """sed -i "s/packages=\['cellbender'\]/packages=setuptools.find_packages()/g" setup.py &&""",
        'checksums': ['68adaf752347655771965e04899a2c06243284b644f52b77614161d73fb7586d'],
    }),
]

sanity_check_commands = ["%(namelower)s --help"]

moduleclass = 'bio'
