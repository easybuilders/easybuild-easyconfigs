easyblock = 'PythonBundle'

name = 'CellBender'
version = '0.3.2'
versionsuffix = '-CUDA-%(cudaver)s'

homepage = 'http://github.com/broadinstitute/CellBender'
description = """
CellBender is a software package for eliminating technical artifacts from
high-throughput single-cell RNA sequencing (scRNA-seq) data.
"""

toolchain = {'name': 'foss', 'version': '2023a'}

dependencies = [
    ('CUDA', '12.1.1', '', SYSTEM),
    ('Python', '3.11.3'),
    ('SciPy-bundle', '2023.07'),
    ('matplotlib', '3.7.2'),
    ('PyTorch', '2.1.2', versionsuffix),
    ('IPython', '8.14.0'),
    ('anndata', '0.10.5.post1'),
    ('jupyter-contrib-nbextensions', '0.7.0'),
    ('pyro-ppl', '1.9.0', versionsuffix),
    ('loompy', '3.0.7'),
    ('PyTables', '3.8.0'),
    ('Qtconsole', '5.5.1'),
]

exts_list = [
    ('async-timeout', '4.0.3', {
        'checksums': ['4640d96be84d82d02ed59ea2b7105a0f7b33abe8703703cd0ab0bf87c427522f'],
    }),
    ('traitlets', '5.14.3', {
        'checksums': ['9ed0579d3502c94b4b3732ac120375cda96f923114522847de4b3bb98b96b6b7'],
    }),
    ('jupyter_console', '6.6.3', {
        'checksums': ['566a4bf31c87adbfadf22cdf846e3069b59a71ed5da71d6ba4d8aaad14a53539'],
    }),
    ('jupyter', '1.1.1', {
        'checksums': ['d55467bceabdea49d7e3624af7e33d59c37fff53ed3a350e1ac957bed731de7a'],
    }),
    ('notebook', '6.5.7', {
        'checksums': ['04eb9011dfac634fbd4442adaf0a8c27cd26beef831fe1d19faf930c327768e4'],
    }),
    ('mistune', '0.8.4', {
        'checksums': ['59a3429db53c50b5c6bcc8a07f8848cb00d7dc8bdb431a4ab41920d201d4756e'],
    }),
    ('nbconvert', '6.5.4', {
        'checksums': ['9e3c7c6d491374cbdd5f35d268c05809357716d346f4573186bbeab32ee50bc1'],
    }),
    ('lxml_html_clean', '0.4.3', {
        'checksums': ['c9df91925b00f836c807beab127aac82575110eacff54d0a75187914f1bd9d8c'],
    }),
    ('cellbender', version, {
        'source_urls': ['https://github.com/broadinstitute/%(name)s/archive/'],
        'sources': ['v%(version)s.tar.gz'],
        'checksums': ['3bd4bf77c82a5817bb09ac3db236e9795e3e71c99cbe34c8baef04272a7d1717'],
    }),
]

sanity_check_paths = {
    'files': ['bin/cellbender'],
    'dirs': ['lib/python%(pyshortver)s/site-packages'],
}

sanity_check_commands = [
    "cellbender --help",
]

moduleclass = 'bio'
