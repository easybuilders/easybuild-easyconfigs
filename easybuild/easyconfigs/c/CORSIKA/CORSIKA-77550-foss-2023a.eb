easyblock = "MakeCp"

name = 'CORSIKA'
version = '77550'

homepage = "https://www.iap.kit.edu/corsika"
description = """CORSIKA (COsmic Ray SImulations for KAscade) is a program for detailed
simulation of extensive air showers initiated by high energy cosmic ray
particles. Protons, light nuclei up to iron, photons, and many other particles
may be treated as primaries."""

toolchain = {'name': 'foss', 'version': '2023a'}
toolchainopts = {'pic': True, 'usempi': True}

download_instructions = "Sources have to be requested to the developers"
sources = [SOURCELOWER_TAR_GZ]
checksums = ['fed74c144e22deb5a7c1d2dc1f04f0100eb2732cb48665a3da49ce471a3775ee']

dependencies = [
    ("ROOT", "6.30.06"),
]

# run in non-interactive mode
build_cmd = "./coconut --batch"
# coconut script does not accept "-j"
parallel = False

files_to_copy = [
    (['run/corsika77550Linux_EPOS_urqmd'], 'bin'),
]

postinstallcmds = [
    "cd %(installdir)s/bin && ln -s corsika77550Linux_EPOS_urqmd corsika",
]

sanity_check_paths = {
    'files': ['bin/corsika', 'bin/corsika77550Linux_EPOS_urqmd'],
    'dirs': []
}

moduleclass = "phys"
