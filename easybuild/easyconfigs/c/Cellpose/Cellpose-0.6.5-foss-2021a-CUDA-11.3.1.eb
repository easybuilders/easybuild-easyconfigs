# This easyconfig was created by the BEAR Software team at the University of Birmingham.
easyblock = 'PythonBundle'

name = 'Cellpose'
version = '0.6.5'
versionsuffix = '-CUDA-%(cudaver)s'

homepage = "https://www.cellpose.org/"
description = """a generalist algorithm for cellular segmentation"""

toolchain = {'name': 'foss', 'version': '2021a'}

dependencies = [
    ('numba', '0.53.1'),
    ('OpenCV', '4.5.3', '-CUDA-%(cudaver)s-contrib'),
    ('Python', '3.9.5'),
    ('PyQt5', '5.15.4'),
    ('PyTorch', '1.9.1', '-CUDA-%(cudaver)s-imkl'),
    ('tqdm', '4.61.1'),
    ('CUDA', '11.3.1', '', True),
]

sanity_pip_check = True
use_pip = True

exts_default_options = {
    'source_urls': [PYPI_SOURCE],
}

exts_list = [
    ('natsort', '7.1.1', {
        'checksums': ['00c603a42365830c4722a2eb7663a25919551217ec09a243d3399fa8dd4ac403'],
    }),
    ('tifffile', '2021.8.8', {
        'checksums': ['8260f31c4700143e8374ff6cde5cef7fe54fc9b7313afe88329f407881901dc5'],
    }),
    ('pyqtgraph', '0.12.2', {
        'checksums': ['fd0cf0678267b65ec28fb4908a7393424978a8c4b369e5749daf8861478fa4ca'],
    }),
    (name, version, {
        'patches': [
            '%(name)s-%(version)s_OpenCV.patch',
            '%(name)s-%(version)s_PyQt5.patch',
        ],
        'source_tmpl': '%(namelower)s-%(version)s.tar.gz',
        'use_pip_extras': 'gui',
        'checksums': [
            '19aafedfe5723285f270ad55e7947fbd828abff943a13216a8205809e41fb870',  # cellpose-0.6.5.tar.gz
            '9c7e431e59380608d69537aa499a3ec7810ebe359d05b090f49d50b3d90703d1',  # Cellpose-0.6.5_OpenCV.patch
            '97fc96189993127998fd1388228a4a1b52bbe15d7355162579259a795ebbd937',  # Cellpose-0.6.5_PyQt5.patch
        ],
    }),
]

moduleclass = 'bio'
