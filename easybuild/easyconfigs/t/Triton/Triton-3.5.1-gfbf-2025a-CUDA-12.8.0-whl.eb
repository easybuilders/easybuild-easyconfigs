easyblock = 'PythonBundle'

name = 'Triton'
version = '3.5.1'
versionsuffix = '-CUDA-%(cudaver)s-whl'

homepage = 'https://triton-lang.org/'
description = """Triton is a language and compiler for parallel programming. It aims to provide a
Python-based programming environment for productively writing custom DNN compute
kernels capable of running at maximal throughput on modern GPU hardware.
This module provides the official wheels of Triton from pytorch.org"""

toolchain = {'name': 'gfbf', 'version': '2025a'}

_torch_wheel_pyver = 'cp%(pymajver)s%(pyminver)s-cp%(pymajver)s%(pyminver)s'
_torch_wheel_source = {
    'aarch64': f'triton-{version}-{_torch_wheel_pyver}-manylinux_2_27_aarch64.manylinux_2_28_aarch64.whl',
    'x86_64': f'triton-{version}-{_torch_wheel_pyver}-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl'
}

dependencies = [
    ('CUDA', '12.8.0', '', SYSTEM),
    ('Python', '3.13.1'),
    ('SciPy-bundle', '2025.06'),
]

exts_list = [
    ('triton', version, {
        'source_urls': ['https://download.pytorch.org/whl'],
        'sources': [_torch_wheel_source[ARCH]],
        'checksums': [{
            'triton-3.5.1-cp313-cp313-manylinux_2_27_aarch64.manylinux_2_28_aarch64.whl':
                '34e02e5406194a7071a703c9fddde133a590369a670ad81a9b4a0e98320617a9',
            'triton-3.5.1-cp313-cp313-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl':
                'e5cfa13cb273cee1043fbf9cb61c4438deb16d57b37b2c277b945ef185890c66',
        }],
    }),
]

moduleclass = 'ai'
