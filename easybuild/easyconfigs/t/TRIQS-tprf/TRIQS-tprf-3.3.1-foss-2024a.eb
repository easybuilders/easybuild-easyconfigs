easyblock = 'CMakeMake'

name = 'TRIQS-tprf'
version = '3.3.1'

homepage = 'https://triqs.github.io/tprf'
description = """
 TRIQS (Toolbox for Research on Interacting Quantum Systems) is a
 scientific project providing a set of C++ and Python libraries to
 develop new tools for the study of interacting quantum systems.

 TPRF is a TRIQS-based two-particle response function tool box that
 implements basic operations for higher order response functions such
 as inversion, products, the random phase approximation, the bethe
 salpeter equation (in the local vertex approximation), etc..

 The aim is to provide efficient (C++/OpenMP/MPI) implementations of
 the basic operations needed to compute the two-particle response in
 the different two-particle channels (particle-hole, particle-particle).
"""

docurls = ['https://triqs.github.io/tprf/%(version_major_minor)s.x/']
software_license = 'LicenseGPLv3'

toolchain = {'name': 'foss', 'version': '2024a'}
toolchainopts = {'pic': True, 'usempi': True}

source_urls = ['https://github.com/TRIQS/tprf/releases/download/%(version)s/']
sources = ['tprf-%(version)s.tar.gz']
checksums = ['4a39648629888ec07c1a5c333ae5aa85ac04a46a7ec3b5d5d588cfe5246b7572']

dependencies = [
    ('Python', '3.12.3'),
    ('SciPy-bundle', '2024.05'),
    ('Boost', '1.85.0'),
    ('Clang', '18.1.8'),
    ('Clang-Python-bindings', '18.1.8'),
    ('GMP', '6.3.0'),
    ('HDF5', '1.14.5'),
    ('Mako', '1.3.5'),
    ('TRIQS', '3.3.1'),
]

builddependencies = [
    ('CMake', '3.29.3')
]

separate_build_dir = True

runtest = 'test'

sanity_check_paths = {
    'files': ['lib/libtriqs_tprf_c.a'],
    'dirs': ['include/triqs_tprf', 'lib', 'share',
             'lib/python%(pyshortver)s/site-packages/triqs_tprf'],
}

sanity_check_commands = ["python -c 'import triqs_tprf'"]

modextrapaths = {
    'CPLUS_INCLUDE_PATH': 'include',
    'PYTHONPATH': 'lib/python%(pyshortver)s/site-packages',
    'CMAKE_PREFIX_PATH': 'lib/cmake/triqs_tprf',
}
modextravars = {
    'TRIQS_TPRF_ROOT': '%(installdir)s',
    'TRIQS_TPRF_VERSION': '%(version)s'
}

moduleclass = 'phys'
