# Author: J. Sassmannshausen (Imperial College London/UK)

easyblock = 'CMakeMake'

name = 'tblite'
version = '0.4.0'

homepage = 'https://github.com/tblite/tblite'
description = "Light-weight tight-binding framework"

toolchain = {'name': 'gfbf', 'version': '2025a'}

source_urls = [GITHUB_SOURCE]
sources = [V_VERSION_TAR_GZ]
patches = ['%(name)s-%(version_major_minor)s.0_failed-test.patch']
checksums = [
    {'v0.%(version_minor_patch)s.tar.gz': 'c4a67dfbe04827095fd7598183e076fa3017a5a475c4f90fd28e78992dc19ea7'},
    {'%(name)s-%(version_major_minor)s.0_failed-test.patch':
     'e2c4bd428ed8f264f992db17cf1bc6e6ae1642aaaa8c112bae134c9021fc886d'},
]

builddependencies = [
    ('binutils', '2.42'),
    ('CMake', '3.31.3'),
    ('meson-python', '0.18.0'),
]
dependencies = [
    ('mctc-lib', '0.5.0'),
    ('mstore', '0.3.0'),
    ('Simple-DFTD3', '1.2.1'),
    ('dftd4', '3.7.0'),
    ('Python', '3.13.1'),
    ('SciPy-bundle', '2025.06'),
]

github_account = '%(name)s'
runtest = ''
exts_defaultclass = 'PythonPackage'
# run suite of tests with ctest
test_cmd = "ctest --parallel 1"
build_shared_libs = True

exts_default_options = {'source_urls': ['https://pypi.python.org/packages/source/%(nameletter)s/%(name)s']}

exts_list = [
    ('tblite', '0.4.0', {'checksums': ['c2334dced8e61e26cd24e1ddb53d10aa0d685cf4df451fc8547192163cddc113']}),
]

sanity_check_paths = {
    'files': ['bin/tblite', f'lib/libtblite.{SHLIB_EXT}'],
    'dirs': ['include/tblite', 'lib/cmake', 'lib/pkgconfig', 'lib/python%(pyshortver)s/site-packages'],
}

sanity_check_commands = ['mctc-convert --help']

moduleclass = 'chem'
