easyblock = 'Tarball'

name = 'shovill'
version = '1.1.0'
versionsuffix = '-Python-2.7.18'

homepage = 'https://github.com/tseemann/shovill'
description = "Faster SPAdes assembly of Illumina reads"

toolchain = {'name': 'foss', 'version': '2020b'}

source_urls = ['https://github.com/tseemann/shovill/archive/']
sources = ['v%(version)s.tar.gz']

# excluded (optional) dependency: skesa
# cfr. https://github.com/ncbi/ngs-tools/tree/master/tools/skesa
dependencies = [
    ('SAMtools', '1.11'),
    ('BWA', '0.7.17'),
    ('seqtk', '1.3'),
    ('SKESA', '2.4.0'),
    ('MEGAHIT', '1.2.9', versionsuffix),
    ('KMC', '3.1.2rc1'),
    ('Pilon', '1.23', '-Java-11', True),
    ('SPAdes', '3.15.2'),
    ('Lighter', '1.1.2'),
    ('FLASH', '1.2.11'),
    ('Trimmomatic', '0.39', '-Java-11', True),
    ('Velvet', '1.2.10', '-mt-kmer_191'),
    ('pigz', '2.6'),
    ('samclip', '0.4.0'),
]

postinstallcmds = [
    """echo exec java -jar \$EBROOTTRIMMOMATIC/trimmomatic-*.jar '"$@"' > %(installdir)s/bin/trimmomatic""",
    """echo exec java -jar $EBROOTPILON/pilon-*.jar '"$@"' > %(installdir)s/bin/pilon""",
    "chmod a+rx %(installdir)s/bin/trimmomatic %(installdir)s/bin/pilon",
]

sanity_check_paths = {
    'files': ['bin/shovill'],
    'dirs': [],
}

sanity_check_commands = ["shovill --check"]

moduleclass = 'bio'
