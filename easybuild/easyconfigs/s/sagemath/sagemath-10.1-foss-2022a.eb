easyblock = 'PythonBundle'

name = 'sagemath'
version = '10.1'

homepage = 'https://www.sagemath.org/'
description = """SageMath is a free open-source mathematics software system licensed under the GPL. It builds on
 top of many existing open-source packages: NumPy, SciPy, matplotlib, Sympy, Maxima, GAP, FLINT, R and many more.
 Access their combined power through a common, Python-based language or directly via interfaces or wrappers.

 This installation method is based on https://github.com/sagemath/sage#alternative-installation-using-pypi
 but providing the mandatory dependencies via eb instead of building the wheels via sage_conf.
"""

toolchain = {'name': 'foss', 'version': '2022a'}

builddependencies = [
    ('CMake', '3.24.3'),
    ('pkgconfig', '1.5.5', '-python'),
]

dependencies = [
    ('SYMMETRICA', '2.0'),
    ('Arb', '2.23.0'),
    ('Boost', '1.79.0'),
    ('BRiAl', '1.2.12'),
    ('ECL', '23.9.9'),
    ('GMP-ECM', '7.0.5'),
    ('GSL', '2.7'),
    ('JupyterLab', '3.5.0'),
    ('LinBox', '1.7.0'),
    ('MPFI', '1.5.4'),
    ('PARI-GP', '2.15.4'),
    ('Python', '3.10.4'),
    ('SciPy-bundle', '2022.05'),
    ('SuiteSparse', '5.13.0', '-METIS-5.1.0'),
    ('cliquer', '1.21'),
    ('eclib', '20230424'),
    ('gap', '4.12.2'),
    ('gmpy2', '2.1.2'),
    ('libbraiding', '1.2'),
    ('libgd', '2.3.3'),
    ('libhomfly', '1.02r6'),
    ('libpng', '1.6.37'),
    ('m4rie', '20200125'),
    ('planarity', '3.0.2.0'),
    ('rankwidth', '0.9'),
]

use_pip = True
sanity_pip_check = True

exts_list = [
    ('sage-setup', version, {
        'checksums': ['9b9d66072adeb930b4d9dc134a7822aa54cc45a41d1011a52bf1a44154dc6507'],
    }),
    ('cysignals', '1.11.2', {
        'checksums': ['5858b1760fbe21848121b826b2463a67ac5a45caf3d73105497a68618c5a6fa6'],
    }),
    ('cypari2', '2.1.3', {
        'checksums': ['17beb467d3cb39fffec3227c468f0dd8db8a09129faeb95a6bb4c84b2b6c6683'],
    }),
    ('memory-allocator', '0.1.3', {
        'source_tmpl': 'memory_allocator-%(version)s.tar.gz',
        'checksums': ['13805c2ae1c01b7489fab5e8eac9361662b4f2c02412e3652eece48ff6953162'],
    }),
    ('sagemath-standard', version, {
        'modulename': 'sage',
        'patches': ['sagemath-10.1_ecl.patch'],
        'checksums': ['4edbace8880b7ff3aa63bd5381ead0400820a68a929f43c68e93a4f28ee13c52'],
    }),
]

sanity_check_paths = {
    'files': [],
    'dirs': ['lib/python%(pyshortver)s/site-packages/'],
}

moduleclass = 'math'
