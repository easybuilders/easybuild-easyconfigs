# This easyconfig was created by the BEAR Software team at the University of Birmingham.
easyblock = 'CMakeMake'

name = 'SortMeRNA'
version = '4.3.6'

homepage = "https://github.com/biocore/sortmerna"
description = """SortMeRNA is a local sequence alignment tool for filtering, mapping and clustering. The core algorithm
 is based on approximate seeds and allows for sensitive analysis of NGS reads. The main application of SortMeRNA is
 filtering rRNA from metatranscriptomic data. SortMeRNA takes as input files of reads (fasta, fastq, fasta.gz,
 fastq.gz) and one or multiple rRNA database file(s), and sorts apart aligned and rejected reads into two files.
 SortMeRNA works with Illumina, Ion Torrent and PacBio data, and can produce SAM and BLAST-like alignments."""

toolchain = {'name': 'foss', 'version': '2021b'}

github_account = 'biocore'
source_urls = [GITHUB_LOWER_SOURCE]
sources = ['v%(version)s.tar.gz']
checksums = ['1ddb7a9f50b63ab5b87c15855a4080949fb0ee0f33ecf0ea8dfb1c1c44cbe9da']

builddependencies = [
    ('CMake', '3.22.1'),
]

dependencies = [
    ('ConcurrentQueue', '1.0.3'),
    ('RapidJSON', '1.1.0'),
    ('RocksDB', '7.9.2'),
    ('zlib', '1.2.11'),
]

_copts = [
    '-DCONCURRENTQUEUE_HOME=$EBROOTCONCURRENTQUEUE/include/concurrentqueue',
    '-DRAPIDJSON_HOME=$EBROOTRAPIDJSON',
    '-DROCKSDB_HOME=$EBROOTROCKSDB',
    '-DROCKSDB_STATIC=OFF',
    '-DZLIB_HOME=$EBROOTZLIB',
    '-DCMAKE_CXX_STANDARD_LIBRARIES="-lpthread"',
    '-DPORTABLE=OFF',
]
configopts = ' '.join(_copts)

sanity_check_paths = {
    'files': ['bin/sortmerna'],
    'dirs': [],
}

sanity_check_commands = ["sortmerna -h"]

moduleclass = 'bio'
