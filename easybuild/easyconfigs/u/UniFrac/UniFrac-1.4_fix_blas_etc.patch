Fix BLAS and LAPACK headers and libraries
Make sure libssu is found for capi_test
Author: Samuel Moors (Vrije Universiteit Brussel)

Updated for 1.4, Ã…ke Sandgren
diff -ru unifrac-binaries-1.4.orig/src/Makefile unifrac-binaries-1.4/src/Makefile
--- unifrac-binaries-1.4.orig/src/Makefile	2023-08-22 22:17:55.000000000 +0200
+++ unifrac-binaries-1.4/src/Makefile	2024-07-23 13:29:03.274621611 +0200
@@ -36,7 +36,7 @@
 	PREFIX := $(CONDA_PREFIX)
 endif
 
-BLASLIB=-llapacke -lcblas
+BLASLIB=-llapacke -lflexiblas
 
 ifeq ($(PLATFORM),Darwin)
 	AVX2 := $(shell sysctl -a | grep -c AVX2)
diff -ru unifrac-binaries-1.4.orig/src/skbio_alt.cpp unifrac-binaries-1.4/src/skbio_alt.cpp
--- unifrac-binaries-1.4.orig/src/skbio_alt.cpp	2023-08-22 22:17:55.000000000 +0200
+++ unifrac-binaries-1.4/src/skbio_alt.cpp	2024-07-23 13:30:41.181914963 +0200
@@ -10,8 +10,8 @@
 #include <algorithm>
 
 // Not using anything mkl specific, but this is what we get from Conda
-#include <mkl_cblas.h>
-#include <mkl_lapacke.h>
+#include <cblas.h>
+#include <lapacke.h>
 
 static std::mt19937 myRandomGenerator;
 
diff -ru unifrac-binaries-1.4.orig/test/Makefile unifrac-binaries-1.4/test/Makefile
--- unifrac-binaries-1.4.orig/test/Makefile	2023-08-22 22:17:55.000000000 +0200
+++ unifrac-binaries-1.4/test/Makefile	2024-07-23 13:32:32.325072666 +0200
@@ -13,7 +13,7 @@
 test_binaries: capi_test
 
 capi_test: capi_test.c
-	$(CC) $(CFLAGS) -std=c99 -O0 -g capi_test.c -I../src -lssu -L${PREFIX}/lib -Wl,-rpath,${PREFIX}/lib $(LDFLAGS) -o capi_test
+	$(CC) $(CFLAGS) -std=c99 -O0 -g capi_test.c -I../src -lssu -L../src -Wl,-rpath,../src $(LDFLAGS) -o capi_test
 
 clean:
 	-rm -f *.o capi_test
