##
# This is a contribution from SIB Swiss Institute of Bioinformatics
# Homepage:     https://www.sib.swiss/research-infrastructure/competence-centers/vital-it
#
# Authors::     Sebastien Moretti <sebastien.moretti@sib.swiss>
#
##

easyblock = 'PythonBundle'

name = 'dvc'
version = '3.26.2'

homepage = 'https://dvc.org/'
description = """(Not Just) Data Version Control"""
# software_license = 'LicenseApachev2'

toolchain = {'name': 'GCCcore', 'version': '10.3.0'}

builddependencies = [
    ('binutils', '2.36.1'),
]

dependencies = [
    ('Python',            '3.9.5'),
    ('git',               '2.32.0',  '-nodocs'),
    ('GitPython',         '3.1.18'),
    ('networkx',          '2.5.1',   '', ('foss', '2021a')),
    ('PyYAML',            '5.4.1'),
    ('ruamel.yaml',       '0.17.21'),
    ('SciPy-bundle',      '2021.05', '', ('foss', '2021a')),
    ('tqdm',              '4.61.2'),
]

use_pip = True

exts_list = [
    # Azure
    ('dvc-azure', '2.23.0', {
        'modulename': 'dvc_azure',
        'checksums': ['d3e1b69f5cac445fe0825e6190eb145b650f3a6e98d44c5914148c7ceac44328'],
    }),
    ('argcomplete', '3.1.2', {
        'checksums': ['d5d1e5efd41435260b8f85673b74ea2e883affcbec9f4230c582689e8e78251b'],
    }),
    ('knack', '0.11.0', {
        'checksums': ['eb6568001e9110b1b320941431c51033d104cc98cda2254a5c2b09ba569fd494'],
    }),
    ('msal', '1.24.1', {
        'checksums': ['aa0972884b3c6fdec53d9a0bd15c12e5bd7b71ac1b66d746f54d128709f3f8f8'],
    }),
    ('azure-datalake-store', '0.0.53', {
        'modulename': 'azure.datalake',
        'source_tmpl': 'azure_datalake_store-%(version)s-py2.py3-none-any.whl',
        'checksums': ['a30c902a6e360aa47d7f69f086b426729784e71c536f330b691647a51dc42b2b'],
    }),
    ('isodate', '0.6.1', {
        'checksums': ['48c5881de7e8b0a0d648cb024c8062dc84e7b840ed81e864c7614fd3c127bde9'],
    }),
    ('requests-oauthlib', '1.3.1', {
        'modulename': 'requests_oauthlib',
        'checksums': ['75beac4a47881eeb94d5ea5d6ad31ef88856affe2332b9aafb52c6452ccf0d7a'],
    }),
    ('oauthlib', '3.2.2', {
        'checksums': ['9859c40929662bec5d64f34d01c99e093149682a3f38915dc0655d5a633dd918'],
    }),
    ('msrest', '0.7.1', {
        'source_tmpl': '%(name)s-%(version)s-py3-none-any.whl',
        'checksums': ['21120a810e1233e5e6cc7fe40b474eeb4ec6f757a15d7cf86702c369f9567c32'],
    }),
    ('azure-storage-blob', '12.18.3', {
        'modulename': 'azure.storage',
        'source_tmpl': 'azure_storage_blob-%(version)s-py3-none-any.whl',
        'checksums': ['c278dde2ac41857a68d615c9f2b36d894ba877a7e84d62795603c7e79d0bb5e9'],
    }),
    ('azure-core', '1.29.4', {
        'modulename': 'azure.core',
        'source_tmpl': 'azure_core-%(version)s-py3-none-any.whl',
        'checksums': ['b03261bcba22c0b9290faf9999cedd23e849ed2577feee90515694cea6bc74bf'],
    }),
    ('azure-identity', '1.14.1', {
        'modulename': 'azure',
        'source_tmpl': 'azure_identity-%(version)s-py3-none-any.whl',
        'checksums': ['3a5bef8e9c3281e864e869739be8d67424bff616cddae96b546ca2a5168d863d'],
    }),
    ('adlfs', '2023.10.0', {
        'checksums': ['f5cf06c5b0074d17d43838d4c434791a98420d9e768b36a1a02c7b3930686543'],
    }),
    # S3
    ('dvc-s3', '2.23.0', {
        'modulename': 'dvc_s3',
        'checksums': ['1f28598f5b0def4a350933428aba062a368c93bb411aa3c6d8f46cae79b5b957'],
    }),
    ('typing-extensions', '4.4.0', {
        'modulename': 'typing_extensions',
        'source_tmpl': 'typing_extensions-%(version)s.tar.gz',
        'checksums': ['1511434bb92bf8dd198c12b1cc812e800d4181cfcb867674e0f8279cc93087aa'],
    }),
    ('aioitertools', '0.11.0', {
        'checksums': ['42c68b8dd3a69c2bf7f2233bf7df4bb58b557bca5252ac02ed5187bbc67d6831'],
    }),
    ('wrapt', '1.15.0', {
        'checksums': ['d06730c6aed78cee4126234cf2d071e01b44b915e725a6cb439a879ec9754a3a'],
    }),
    ('aiobotocore', '2.7.0', {
        'checksums': ['506591374cc0aee1bdf0ebe290560424a24af176dfe2ea7057fe1df97c4f0467'],
    }),
    ('s3fs', '2023.9.2', {
        'checksums': ['64cccead32a816422dd9ae1d693c5d6354d99f64ae26c56388f1d8e1c7858321'],
    }),
    # default dvc + http/https
    ('jmespath', '1.0.1', {
        'checksums': ['90261b206d6defd58fdd5e85f478bf633a2901798906be2ad389150c5c60edbe'],
    }),
    ('botocore', '1.31.66', {
        'checksums': ['70e94a5f9bd46b26b63a41fb441ad35f2ae8862ad9d90765b6fa31ccc02c0a19'],
    }),
    ('boto3', '1.28.66', {
        'checksums': ['38658585791f47cca3fc6aad03838de0136778b533e8c71c6a9590aedc60fbde'],
    }),
    ('nanotime', '0.5.2', {
        'checksums': ['c7cc231fc5f6db401b448d7ab51c96d0a4733f4b69fabe569a576f89ffdf966b'],
    }),
    ('aiohttp_retry', '2.8.3', {
        'checksums': ['9a8e637e31682ad36e1ff9f8bcba912fcfc7d7041722bc901a4b948da4d71ea9'],
    }),
    ('frozenlist', '1.4.0', {
        'checksums': ['09163bdf0b2907454042edb19f887c6d33806adc71fbd54afc14908bfdc22251'],
    }),
    ('aiosignal', '1.3.1', {
        'checksums': ['54cd96e15e1649b75d6c87526a6ff0b6c1b0dd3459f43d9ca11d48c339b68cfc'],
    }),
    ('charset-normalizer', '3.3.0', {
        'modulename': 'charset_normalizer',
        'checksums': ['63563193aec44bce707e0c5ca64ff69fa72ed7cf34ce6e11d5127555756fd2f6'],
    }),
    ('async-timeout', '4.0.3', {
        'modulename': 'async_timeout',
        'checksums': ['4640d96be84d82d02ed59ea2b7105a0f7b33abe8703703cd0ab0bf87c427522f'],
    }),
    ('zc.lockfile', '3.0.post1', {
        'checksums': ['adb2ee6d9e6a2333c91178dcb2c9b96a5744c78edb7712dc784a7d75648e81ec'],
    }),
    ('yarl', '1.9.2', {
        'checksums': ['04ab9d4b9f587c06d801c2abfe9317b77cdf996c65a90d5e84ecc45010823571'],
    }),
    ('multidict', '6.0.4', {
        'checksums': ['3666906492efb76453c0e7b97f2cf459b0682e7402c0489a95484965dbc1da49'],
    }),
    ('atpublic', '4.0', {
        'source_tmpl': 'atpublic-%(version)s-py3-none-any.whl',  # Issue with the tarball
        'checksums': ['80057c55641253b86dcb68b524f82328172371b6547d4c7462a9127fbfbbabfc'],
        'modulename': 'public',
    }),
    ('flufl.lock', '8.0.2', {
        'source_tmpl': 'flufl_lock-%(version)s-py3-none-any.whl',
        'checksums': ['ca33fb581122d651e4f24775bebed1e58cd1ea85a95a505881902ba050ed170b'],
    }),
    ('aiohttp', '3.8.6', {
        'checksums': ['b0cf2a4501bff9330a8a5248b4ce951851e415bdcce9dc158e76cfd55e15085c'],
    }),
    ('dvc-task', '0.3.0', {
        'modulename': 'dvc_task',
        'checksums': ['6ab288bfbbc4a2df8ef145c543bb979d6cb8fb49037fec821a59ad6e1dfdddce'],
    }),
    ('flatten-dict', '0.4.2', {
        'modulename': 'flatten_dict',
        'checksums': ['506a96b6e6f805b81ae46a0f9f31290beb5fa79ded9d80dbe1b7fa236ab43076'],
    }),
    ('dvc-render', '0.6.0', {
        'modulename': 'dvc_render',
        'checksums': ['69b7dfdadf890beb6d7fa5b3d4bd33323d78fc4c3ce33ed1bf777026192f9b4d'],
    }),
    ('fsspec', '2023.9.2', {
        'checksums': ['80bfb8c70cc27b2178cc62a935ecf242fc6e8c3fb801f9c571fc01b1e715ba7d'],
    }),
    ('dvc-objects', '1.0.1', {
        'modulename': 'dvc_objects',
        'checksums': ['a9fdf55552b95d3dfa1d4572b3938e893c4b4365bb551e168e164fcf5eab93dd'],
    }),
    ('dvc-http', '2.30.2', {
        'modulename': 'dvc_http',
        'checksums': ['d7cf66e8f8359cc9f5ca137de24d259beebdec444516fc7d085ad26fa7d3b34b'],
    }),
    ('pathspec', '0.11.2', {
        'checksums': ['e0d8d0ac2f12da61956eb2306b69f9469b42f4deb0f3cb6ed47b9cce9996ced3'],
    }),
    ('platformdirs', '3.11.0', {
        'source_tmpl': '%(name)s-%(version)s-py3-none-any.whl',
        'checksums': ['e9d171d00af68be50e9202731309c4e658fd8bc76f55c11c7dd760d023bda68e'],
    }),
    ('shortuuid', '1.0.11', {
        'checksums': ['fc75f2615914815a8e4cb1501b3a513745cb66ef0fd5fc6fb9f8c3fa3481f789'],
    }),
    ('dulwich', '0.21.6', {
        'source_tmpl': 'dulwich-%(version)s-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl',
        'checksums': ['81d10aa50c0a9a6dd495990c639358e3a3bbff39e17ff302179be6e93b573da7'],
    }),
    ('scmrepo', '1.4.0', {
        'checksums': ['9548b3fe5de7240bb52d2c9b81da24dd31fa9f612776cfd20e72c8c9e9ddef13'],
    }),
    ('dpath', '2.1.6', {
        'checksums': ['f1e07c72e8605c6a9e80b64bc8f42714de08a789c7de417e49c3f87a19692e47'],
    }),
    ('diskcache', '5.6.3', {
        'checksums': ['2c3a3fa2743d8535d832ec61c2054a1641f41775aa7c556758a109941e33e4fc'],
    }),
    ('orjson', '3.9.9', {
        # Issue with the tarball
        'source_tmpl': 'orjson-%(version)s-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.whl',
        'checksums': ['06f0c024a75e8ba5d9101facb4fb5a028cdabe3cdfe081534f2a9de0d5062af2'],
    }),
    ('sqltrie', '0.8.0', {
        'checksums': ['a773e41f00ae9215a79d3e0537526eaf5e37100037a2ef042d09edcc209abc9e'],
    }),
    ('attrs', '23.1.0', {
        'source_tmpl': 'attrs-%(version)s-py3-none-any.whl',  # Issue with the tarball
        'checksums': ['1f28b4522cdc2fb4256ac1a020c78acf9cba2c6b461ccd2c126f3aa8e8335d04'],
    }),
    ('dvc-data', '2.18.1', {
        'modulename': 'dvc_data',
        'checksums': ['2150046baa8519ac8f0f6b314e48878a5af5742cbf13453fb6f9b1d2bf44a22a'],
    }),
    ('pygtrie', '2.5.0', {
        'checksums': ['203514ad826eb403dab1d2e2ddd034e0d1534bbe4dbe0213bb0593f66beba4e2'],
    }),
    ('voluptuous', '0.13.1', {
        'checksums': ['e8d31c20601d6773cb14d4c0f42aee29c6821bbd1018039aac7ac5605b489723'],
    }),
    ('shtab', '1.6.4', {
        'source_tmpl': 'shtab-%(version)s-py3-none-any.whl',  # Issue with the tarball
        'checksums': ['4be38887a912091a1640e06f5ccbcbd24e176cf2fcb9ef0c2e011ee22d63834f'],
    }),
    ('funcy', '2.0', {
        'checksums': ['3963315d59d41c6f30c04bc910e10ab50a3ac4a225868bfa96feed133df075cb'],
    }),
    (name, version, {
        'use_pip_extras': 'all',
        'source_tmpl': 'dvc-%(version)s-py3-none-any.whl',  # Issue with the tarball
        'checksums': ['ca989469239d7348ca77ef91a22dcf3270c6e093f79701d2b9ccc8e599c48522'],
    }),
]

sanity_check_paths = {
    'files': ['bin/dvc'],
    'dirs': ['lib/python%(pyshortver)s/site-packages'],
}

sanity_pip_check = False
sanity_check_commands = ["dvc --version && dvc doctor"]

moduleclass = 'tools'
