easyblock = 'PythonPackage'

name = 'jax'
version = '0.1.55'

homepage = 'https://github.com/google/jax'
description = """JAX is Autograd and XLA, brought together for high-performance 
machine learning research.

With its updated version of Autograd, JAX can automatically differentiate native 
Python and NumPy functions. It can differentiate through loops, branches, 
recursion, and closures, and it can take derivatives of derivatives of derivatives.
It supports reverse-mode differentiation (a.k.a. backpropagation) via grad as well 
as forward-mode differentiation, and the two can be composed arbitrarily to any order."""

toolchain = {'name': 'foss', 'version': '2020b'}

source_urls = ['https://github.com/google/jax/archive']
sources = ['jax-v%(version)s.tar.gz']
checksums = ['466f0c2c8263853653e0b1099a90433a6e5d03e22bb4eddf8ac103da1c6d986c']

# builddependencies = [
#    ('binutils', '2.35'),
#    ('Bazel', '3.7.2'),
# ]

dependencies = [
    ('Python', '3.8.6'),
    ('absl-py', '0.13.0'),
    ('opt-einsum', '3.3.0'),
    ('fastcache', '1.1.0'),
#    ('dm-tree', '0.1.5'),
#    ('jaxlib', '7.5.1'),
    ('SciPy-bundle', '2020.11'),
]

download_dep_fail = True

use_pip = True
sanity_pip_check = True

#options = {'modulename': 'haiku'}

moduleclass = 'lib'
