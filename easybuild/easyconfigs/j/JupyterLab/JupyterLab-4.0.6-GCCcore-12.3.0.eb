easyblock = 'PythonBundle'

name = 'JupyterLab'
version = '4.0.6'

homepage = 'https://jupyter.org/'
description = """JupyterLab is the next-generation user interface for Project Jupyter offering all the familiar
  building blocks of the classic Jupyter Notebook (notebook, terminal, text editor, file browser, rich outputs,
  etc.) in a flexible and powerful user interface. JupyterLab will eventually replace the classic Jupyter
  Notebook.
"""

toolchain = {'name': 'GCCcore', 'version': '12.3.0'}

builddependencies = [
    ('binutils', '2.40'),
    ('hatch-jupyter-builder', '0.8.3'),
]
dependencies = [
    ('Python', '3.11.3'),
    ('IPython', '8.16.1'),
    ('jupyter-server', '2.7.3'),
]

# keep user's configuration in their home directory
# note: '~' is not expanded by JupyterLab
modluafooter = """
setenv("JUPYTERLAB_SETTINGS_DIR", pathJoin(os.getenv("HOME"), ".jupyter", "lab", "user-settings"))
setenv("JUPYTERLAB_WORKSPACES_DIR", pathJoin(os.getenv("HOME"), ".jupyter", "lab", "workspaces"))
"""
modtclfooter = """
setenv JUPYTERLAB_SETTINGS_DIR "$::env(HOME)/.jupyter/lab/user-settings"
setenv JUPYTERLAB_WORKSPACES_DIR "$::env(HOME)/.jupyter/lab/workspaces"
"""
sanity_pip_check = True
use_pip = True

exts_list = [
    ('json5', '0.9.14', {
        'checksums': ['9ed66c3a6ca3510a976a9ef9b8c0787de24802724ab1860bc0153c7fdd589b02'],
    }),
    ('jupyterlab_server', '2.25.0', {
        'checksums': ['77c2f1f282d610f95e496e20d5bf1d2a7706826dfb7b18f3378ae2870d272fb7'],
    }),
    ('jupyterlab-lsp', '5.0.0', {
        'checksums': ['0f88e26803d0f3e4c8c8bef08a9f861f2706a77ca6d4d92f65026c09e958164b'],
    }),
    ('async-lru', '2.0.4', {
        'checksums': ['b8a59a5df60805ff63220b2a0c5b5393da5521b113cd5465a44eb037d81a5627'],
    }),
    ('jupyter-lsp', '2.2.0', {
        'checksums': ['8ebbcb533adb41e5d635eb8fe82956b0aafbf0fd443b6c4bfa906edeeb8635a1'],
    }),
    ('jupyterlab', version, {
        'checksums': ['6c43ae5a6a1fd2fdfafcb3454004958bde6da76331abb44cffc6f9e436b19ba1'],
    }),
]

local_binaries = [
    'jupyter-lab',
    'jupyter-labextension',
    'jupyter-labhub',
]
sanity_check_paths = {
    'files': [],
    'dirs': ['etc/jupyter', 'share/jupyter'],
}

sanity_check_commands = ['jupyter lab --help']

modextrapaths = {
    'JUPYTER_CONFIG_PATH': 'etc/jupyter',
    'JUPYTER_PATH': 'share/jupyter',
}

modextravars = {'JUPYTERLAB_DIR': '%(installdir)s/share/jupyter/lab'}

moduleclass = 'tools'
