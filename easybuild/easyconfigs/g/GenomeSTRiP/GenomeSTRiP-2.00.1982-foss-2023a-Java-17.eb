# #
# This is a contribution from HPCNow! (http://hpcnow.com)
# Copyright::   HPCNow!
# Authors::     Jordi Blasco <jordi.blasco@hpcnow.com>; Guillermo Piccoli <guillermo.piccoli@hpcnow.com>
# License::     GPL-v3.0
# #

easyblock = 'Tarball'

name = 'GenomeSTRiP'
version = '2.00.1982'
versionsuffix = '-Java-17'

homepage = 'https://www.broadinstitute.org/software/genomestrip'
description = """Genome STRiP (Genome STRucture In Populations) is a suite of
tools for discovery and genotyping of structural variation using whole-genome
sequencing data. The methods used in Genome STRiP are designed to find shared
variation using data from multiple individuals. Genome STRiP looks both across
and within a set of sequenced genomes to detect variation."""

toolchain = {'name': 'foss', 'version': '2023a'}

# Current and previous releases are available from the official website.
# Manual download is required due to license restrictions.
# http://www.broadinstitute.org/software/genomestrip.
sources = ['svtoolkit_%(version)s.tar.gz']
checksums = ['d2259bcf00b616aebb1df7a1ddf9f774fa2fcf06c162ed71af3cd27de8cb7a94']

dependencies = [
    ('Java', '17.0.6', '', SYSTEM),
    ('R', '4.3.2'),
    ('SAMtools', '1.18'),
    ('tabixpp', '1.1.2'),
    ('GATK', '4.5.0.0', versionsuffix),
    ('picard', '3.0.0', versionsuffix, SYSTEM),
    ('BWA', '0.7.17'),
]

# runtest = 'cd installtest; ./discovery.sh; ./genotyping.sh'

sanity_check_paths = {
    'files': ['bwa/bwa', 'lib/SVToolkit.jar', 'lib/gatk/GenomeAnalysisTK.jar'],
    'dirs': ['R', 'bwa', 'conf', 'cookbook', 'doc', 'installtest', 'lib', 'misc', 'qscript', 'scripts', 'wdl'],
}

modextrapaths = {'SV_DIR': ''}

moduleclass = 'bio'
