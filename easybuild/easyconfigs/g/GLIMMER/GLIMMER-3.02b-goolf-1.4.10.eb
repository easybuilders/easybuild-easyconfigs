##
# This file is an EasyBuild reciPY as per https://github.com/hpcugent/easybuild
#
# Copyright:: Copyright 2012-2013 The Cyprus Institute
# Authors::   Andreas Panteli <a.panteli@cyi.ac.cy>, Thekla Loizou <t.loizou@cyi.ac.cy>
# Updated::   Pablo Escobar <pablo.escobarlopez@unibas.ch>
# License::   MIT/GPL
#
##
easyblock='MakeCp'

name = "GLIMMER"
version = "3.02b"

homepage = 'http://www.cbcb.umd.edu/software/glimmer/'
description = """Glimmer is a system for finding genes in microbial DNA, especially
the genomes of bacteria, archaea, and viruses."""

toolchain = {'name': 'goolf', 'version': '1.4.10'}

source_urls = ['http://www.cbcb.umd.edu/software/glimmer']
sources = ['%%(namelower)s%s.tar.gz' % ''.join(version.split('.'))]

dependencies = [('ELPH', '1.0.1')]

buildopts = '-C ./src'

files_to_copy = ["bin", "docs", "glim302notes.pdf", "lib", "LICENSE", "sample-run", "scripts"]

# add scripts dir to PATH
modextrapaths = {
	'PATH': 'scripts'
}

sanity_check_paths = {
    'files': ["bin/glimmer3", "glim302notes.pdf", "LICENSE"],
    'dirs': ["docs", "lib", "sample-run", "scripts"]
}

# fix hardcoded path to scripts folder
postinstallcmds = ["sed -i -e 's|/fs/szgenefinding/Glimmer3/scripts|%(installdir)s/scripts|' %(installdir)s/scripts/*"]
# fix hardcoded path to bin folder
postinstallcmds += ["sed -i -e 's|/fs/szgenefinding/Glimmer3/bin|%(installdir)s/bin|' %(installdir)s/scripts/*"]
# fix hardcoded path to elph binary
postinstallcmds += ["sed -i -e 's|/nfshomes/adelcher/bin/elph|${EBROOTELPH}/bin/elph|' %(installdir)s/scripts/*"]

moduleclass = 'bio'
