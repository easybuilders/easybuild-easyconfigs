easyblock = 'PythonBundle'

name = 'Geneformer'
version = '0.1.0-20241204'
local_commit = '09de197'
versionsuffix = '-CUDA-%(cudaver)s'

homepage = 'https://huggingface.co/ctheodoris/Geneformer'
description = """Geneformer is a foundational transformer model pretrained on a large-scale
corpus of single cell transcriptomes to enable context-aware predictions in settings
with limited data in network biology."""

toolchain = {'name': 'foss', 'version': '2023a'}

builddependencies = [
    ('git-lfs', '3.5.1', '', SYSTEM),
]

dependencies = [
    ('CUDA', '12.1.1', '', SYSTEM),
    ('Python', '3.11.3'),
    ('SciPy-bundle', '2023.07'),
    ('anndata', '0.10.5.post1'),
    ('HF-Datasets', '2.18.0'),
    ('loompy', '3.0.7'),
    ('matplotlib', '3.7.2'),
    ('Optuna', '3.5.0'),
    ('Arrow', '14.0.1'),
    ('Ray-project', '2.9.1'),
    ('scanpy', '1.9.8'),
    ('scikit-learn', '1.3.1'),
    ('Seaborn', '0.13.2'),
    ('statsmodels', '0.14.1'),
    ('tensorboard', '2.15.1'),
    ('PyTorch', '2.1.2', versionsuffix),
    ('tqdm', '4.66.1'),
    ('Transformers', '4.39.3'),
    ('accelerate', '0.33.0', versionsuffix),
]

use_pip = True
sanity_pip_check = True

exts_list = [
    ('optuna_integration', '4.1.0', {
        'source_tmpl': SOURCE_PY3_WHL,
        'checksums': ['d6ce0ffb650f7783e6cc4a4fd2f684fb1252db441414669b14c01f65b1556a2c'],
    }),
    ('peft', '0.13.2', {
        'source_tmpl': SOURCE_PY3_WHL,
        'checksums': ['d4e0951ec78eac11c45a051801c569913436888c578d48e5ce86996b715bc6ef'],
    }),
    ('accumulation_tree', '0.6.4', {
        'checksums': ['5f907667e4106b5ba140b6b871e1902eb2a93d429b92f8a9f7ddb2bee7704334'],
    }),
    ('pyudorandom', '1.0.0', {
        'checksums': ['f30a093a0170c15f9c7f87eb29f71f0f5fde995528b7c6dc4606d389e8c37755'],
    }),
    ('tdigest', '0.5.2.2', {
        'source_tmpl': SOURCE_PY3_WHL,
        'checksums': ['dd25f8d6e6be002192bba9e4b8c16491d36c10b389f50637818603d1f67c6fb2'],
    }),
    (name, version, {
        'sources': [{
            'filename': '%(name)s-%(version)s.tar.gz',
            'git_config': {
                'url': 'https://huggingface.co/ctheodoris',
                'repo_name': name,
                'commit': local_commit,
            },
        }],
        'checksums': [None],
    }),
]

sanity_check_paths = {
    'files': [],
    'dirs': ['lib/python%(pyshortver)s/site-packages'],
}


moduleclass = 'bio'
