# Author: J. Saßmannshausen (Imperial College London/UK)

easyblock = 'PythonBundle'

name = 'G-ADOPT'
version = '4.1.0'

homepage = 'https://gadopt.org/'
description = """
G-ADOPT is a next-generation computational platform for simulating
geoscientific flows with adjoint-based methods, built on Firedrake.
Developed at the ANU’s Research School of Earth Sciences in collaboration
with international partners, it supports applications across mantle and
lithosphere dynamics, glacial isostatic adjustment (GIA), and groundwater
modelling.
"""

toolchain = {'name': 'foss', 'version': '2025b'}

builddependencies = [
    ('setuptools', '80.10.1'),
    ('CMake', '4.0.3'),
    ('pybind11', '3.0.0'),
    ('Boost', '1.88.0'),
    ('Boost.Python', '1.88.0'),
]

dependencies = [
    ('Python', '3.13.5'),
    ('SciPy-bundle', '2025.07'),
    ('matplotlib', '3.10.5'),
    ('fonttools', '4.58.5'),
    ('Pillow', '11.3.0'),
    ('VTK', '9.5.2'),
    ('Firedrake', '2025.10.2'),
]

local_preinstallopts = 'export CMAKE_ARGS="-DTPL_BLAS_LIBRARIES=$EBROOTFLEXIBLAS/lib/libflexiblas.so '
local_preinstallopts += '-DTPL_LAPACK_LIBRARIES=$EBROOTFLEXIBLAS/lib/libflexiblas.so"; '

exts_list = [
    ('pyroltrilinos', '0.5.6', {
        'modulename': 'ROL',
        'preinstallopts': local_preinstallopts,
        'checksums': ['b8c6cd1fc55c21497357eeed0613e81e6b6990d13a3e3e02d795cc23874b8328'],
    }),
    ('gadopt', version, {
        'checksums': ['989183871b8ea3c05deb25d4774b810b873da9c4c259bca7f4c80320d03ef7eb'],
    }),
]

moduleclass = 'geo'
