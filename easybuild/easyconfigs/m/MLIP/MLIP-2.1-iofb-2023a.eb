# #
# Author: Ali Kerrache, University of Manitoba.
# Date: Aug 17, 2021.
# #

easyblock = 'CMakeMake'

name = 'MLIP'
version = '2.1'

homepage = 'https://gitlab.com/ashapeev/mlip-2'
description = """MLIP is a software for Machine Learning Interatomic Potentials. It has been developed at Skoltech (Moscow) by Alexander Shapeev, Evgeny Podryabinkin, Konstantin Gubaev, and Ivan Novikov"""

toolchain = {'name': 'iofb', 'version': '2023a'}
toolchainopts = {'usempi': True, 'openmp': True, 'pic': True}

source_urls = ['https://gitlab.com/ashapeev/mlip-2/-/archive/v%(version)s/']
sources = ['%(namelower)s-2-v%(version)s.tar.gz']
checksums = ['e9532fb213ba604fc8ccd7677624580cc462db308b1e5cbc29130162f8b29ed9']

builddependencies = [('CMake', '3.27.7')]

configopts  = ' -DCMAKE_BUILD_TYPE=Release '
configopts += ' -DWITH_MPI=ON '
configopts += ' -DWITH_SELFTEST=ON '
configopts += ' -DWITH_LOSSLESS_CFG=OFF '
configopts += ' -DWITH_SYSTEM_BLAS=OFF '
#configopts += ' -DBLAS_ROOT=$EBROOTFLEXIBLAS '

max_parallel = 1

sanity_check_paths = {
    'files': ['bin/mlp', 'lib/lib_mlip_interface.a'],
    'dirs': ['bin', 'lib'],
}

moduleclass = 'phys'
