name = 'Mesa'
version = '9.2.2'
versionsuffix = '-OSMesa-Gallium'

homepage = 'http://www.mesa3d.org/'
description = """Mesa is an open-source implementation of the OpenGL specification -
a system for rendering interactive 3D graphics."""
toolchain = {'name': 'goolf', 'version': '2014a'}
toolchainopts = {'optarch': True}

sources = ['%sLib-%s.tar.gz' % (name, version)]
source_urls = [
    'ftp://ftp.freedesktop.org/pub/mesa/%(version)s',
]

osdependencies = [
            'autoconf',  
            'bison',  
            'flex',
            'automake',
            'm4',
        ]

preconfigopts = 'autoreconf -fi && ' 

configopts = " --disable-xvmc --disable-glx  --disable-dri --with-dri-drivers='' --with-gallium-drivers='swrast' "
configopts += " --enable-texture-float --disable-shared-glapi --disable-egl --with-egl-platforms='' --enable-gallium-osmesa"
configopts += " --enable-gallium-llvm=yes --with-llvm-shared-libs"""

sanity_check_paths = { 
                      'files': ['lib/libOSMesa.so', 'lib/libOSMesa.la', 
                                'include/GL/glx_mangle.h', 'include/GL/glx.h', 'include/GL/osmesa.h', 
                                'include/GL/wglext.h', 'include/GL/gl.h', 'include/GL/glxext.h', 
                                'include/GL/gl_mangle.h', 'include/GL/glext.h',
                                'include/GL/wmesa.h'],
                      'dirs': []
                     }

moduleclass = 'vis'
