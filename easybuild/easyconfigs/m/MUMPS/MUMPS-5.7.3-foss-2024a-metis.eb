name = 'MUMPS'
version = '5.7.3'
versionsuffix = '-metis'

homepage = 'https://graal.ens-lyon.fr/MUMPS/'
description = "A parallel sparse direct solver"

toolchain = {'name': 'foss', 'version': '2024a'}
toolchainopts = {'pic': True, 'usempi': True}

source_urls = ['https://mumps-solver.org/']
sources = ['%(name)s_%(version)s.tar.gz']
patches = [
    '%(name)s-%(version)s_shared-pord.patch',  # builds the shared libs of PORD
    '%(name)s-%(version)s_shared-%(namelower)s.patch',  # builds shared libs of %(name)s
]

checksums = [
    {'%(name)s_%(version)s.tar.gz': '84a47f7c4231b9efdf4d4f631a2cae2bdd9adeaabc088261d15af040143ed112'},
    {'%(name)s-%(version)s_shared-pord.patch': 'b9db8620f595ad4fec90f5b0fb275e267aa356d47fcfd5a04d10707970a861d8'},
    {'%(name)s-%(version)s_shared-mumps.patch': '2af9f61482799f923be41d42c3426a21cf1267d76299abae9d403a3e84bcf74f'},
]

dependencies = [
    ('SCOTCH', '7.0.5'),
    ('METIS', '5.1.0'),
]

# fix 'Type mismatch between actual argument' errors with GCC 10.x
prebuildopts = 'export FFLAGS="$FFLAGS -fallow-argument-mismatch" && '
buildopts = 'all SONAME_VERSION="%(version)s"'

max_parallel = 1


moduleclass = 'math'
