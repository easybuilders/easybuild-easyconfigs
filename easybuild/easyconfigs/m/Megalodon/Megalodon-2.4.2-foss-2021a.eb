easyblock = 'PythonBundle'

name = 'Megalodon'
version = '2.4.2'

homepage = 'https://github.com/nanoporetech/megalodon'
description = """Megalodon is a research command line tool to extract high accuracy modified base and sequence variant
calls from raw nanopore reads by anchoring the information rich basecalling neural network output to a reference
genome/transriptome."""

toolchain = {'name': 'foss', 'version': '2021a'}

dependencies = [
    ('Python', '3.9.5'),
    ('SciPy-bundle', '2021.05'),
    ('h5py', '3.2.1'),
    ('scikit-learn', '0.24.2'),
    ('tqdm', '4.61.2'),
    ('Pysam', '0.16.0.1'),
    ('Seaborn', '0.11.2'),
    ('Remora', '0.1.2'),
]

use_pip = True

exts_list = [
    ('progressbar33', '2.4', {
        'modulename': 'progressbar',
        'checksums': ['51fe0d9b3b4023db2f983eeccdfc8c9846b84db8443b9bee002c7f58f4376eff'],
    }),
    ('ont-fast5-api', '4.0.0', {
        'checksums': ['a249813104439bfe3d4e346bb560756e23217655273410c60b9bade205eb3e66'],
    }),
    ('mappy', '2.24', {
        'checksums': ['35a2fb73ef14173283d5abb31e7a318429e0330c3be95851df38dd83d4ff9af9'],
    }),
    ('ont_pyguppy_client_lib', '6.0.1', {
        'modulename': 'pyguppy_client_lib',
        'sources': ['ont_pyguppy_client_lib-%(version)s-cp39-cp39-manylinux2014_x86_64.whl'],
        'checksums': ['71fcf78a44711019e61f74a59e00968874efb712ed65d957268cf3c70792ad0e'],
    }),
    ('megalodon', version, {
        'checksums': ['b6fe6e40bf6f7a70250848de80c97f8845ce24771e20634617bbc1510f4bcbbb'],
    }),
]

sanity_check_paths = {
    'files': ['bin/megalodon'],
    'dirs': ['lib/python%(pyshortver)s/site-packages'],
}

sanity_check_commands = [
    "megalodon -h",
]

sanity_pip_check = True

moduleclass = 'bio'
