easyblock = 'ConfigureMake'

_commit = '07f5ae186d51eac8ccf76e0eeaeacdfd19ee140a'
name = 'MIGRATE-N'
version = '5.0.8'

homepage = 'https://peterbeerli.com/migrate-html5/index.html'
description = """
Migrate estimates population parameters, effective population sizes
and migration rates of n populations, using genetic data.  It
uses a coalescent theory approach taking into account history of
mutations and uncertainty of the genealogy.
"""

toolchain = {'name': 'foss', 'version': '2024a'}

github_account = 'pbeerli'
source_urls = ['https://github.com/%(github_account)s/migrate-5.0.7/archive']
sources = [{'download_filename': f'{_commit}.tar.gz', 'filename': SOURCE_TAR_GZ}]
checksums = ['0e391e343d5103b78f35ef260c653b37ef11b05ae0c9d3f3614d53c2a36cbd83']

builddependencies = [
    ('Autotools', '20231222'),
    ('binutils', '2.42'),
    ('make', '4.4.1'),
    ('pkg-config', '0.29.2'),
]

dependencies = [
    ('libharu', '2.4.5'),
    ('zlib', '1.3.1'),
]

preconfigopts = "autoreconf -fi && "

sanity_check_paths = {
    'files': ['bin/%s' % x for x in ['migrate-n', 'migrate-n-mpi']],
    'dirs': [],
}

sanity_check_commands = [
    "echo Q | migrate-n",
    "echo Q | mpirun -np 1 migrate-n-mpi",
]

moduleclass = 'bio'
