# This is for the custom build of Malt 
# Malt is downloaded from here:
# http://ab.inf.uni-tuebingen.de/data/software/malt/download/welcome.html
# The MALT_unix_0_4_1.sh is executed and the binaries are installed in
# malt/bin
# The malt directory is bundled into a tarball which will be installed
# This is a bit of a hack!
# The homepage is here:
# http://ab.inf.uni-tuebingen.de/software/malt/
# Contribution from the Crick HPC team
# uploaded by J. Sassmannshausen

easyblock = 'Binary'

name = 'MALT'
version = '0.4.1'
local_versionalt = version.replace('.', '_')

homepage = 'http://ab.inf.uni-tuebingen.de/software/malt'
description = """MALT (MEGAN alignment tool) is an extension of MEGAN (metagenome analyzer).
MALT performs alignment of metagenomic reads against a database of reference sequences 
(such as NR, GenBank or Silva) and produces a MEGAN RMA file as output. The software is 
currently under development. """

toolchain = SYSTEM

sources = [{
    'source_urls': ['https://ab.inf.uni-tuebingen.de/data/software/malt/download'],
    'filename': 'MALT_unix_%s.sh' % local_versionalt,
}]

checksums = ['8ccf5f073be6d0960c0886b1fdfc6237515dfaf7d4b71a470db805d72bfc17f3']

# specify dependency on Java/1.8 "wrapper", rather than a specific Java version
dependencies = [('Java', '1.8', '', True)]
builddependencies = [('Java', '1.8', '', True)]

install_cmd = 'bash ./MALT_unix_%s.sh -q -dir .' % local_versionalt

files_to_copy = ['malt-build', 'malt-run']

sanity_check_paths = {
    'files': ['malt-build', 'malt-run'],
    'dirs': ['class', 'jars', 'bin'],
}

moduleclass = 'bio'
