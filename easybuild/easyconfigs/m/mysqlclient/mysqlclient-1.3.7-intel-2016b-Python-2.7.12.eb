easyblock = 'PythonPackage'

name = 'mysqlclient'
version = '1.3.7'
versionsuffix = '-Python-%(pyver)s'

homepage = 'https://github.com/PyMySQL/mysqlclient-python'
description = """Python interface to MySQL"""

toolchain = {'name': 'intel', 'version': '2016b'}

source_urls = [PYPI_SOURCE]
sources = [SOURCE_TAR_GZ]

dependencies = [
    ('Python', '2.7.12'),
    ('MariaDB', '10.1.17'),
]

# swap to binutils 2.27, since binutils 2.26 includes a bug that results in a broken libmysqlclient.so.18
# cfr. https://github.com/hpcugent/easybuild-easyconfigs/issues/3618
preconfigopts = "module swap binutils/2.26-GCCcore-5.4.0 binutils/2.27 && "

# enable static linking to fix problem with unresolved symbols in mysql.so
prebuildopts = "sed -i 's/static = False/static = True/g' site.cfg && "

options = {'modulename': 'MySQLdb'}

sanity_check_paths = {
    'files': [],
    'dirs': ['lib/python%(pyshortver)s/site-packages'],
}

moduleclass = 'lib'
