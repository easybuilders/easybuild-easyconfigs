easyblock = 'MakeCp'

name = 'MXNet'
version = '0.9.3'
suffix = '-Python-%(pyver)s'

homepage = 'http://mxnet.io/' 
description = """Flexible and Efficient Library for Deep Learning"""

toolchain = {'name': 'foss', 'version': '2016b'}
toolchainopts = {'cstd': 'c++11', 'opt': True, 'pic': True, 'openmp': True}

#Download source from github, fix sub branches, checkout to version, clean the directory tree, make the tarball
sources = [SOURCELOWER_TAR_GZ]

patches = ['MXNet-%(version)s_config.patch']

dependencies = [
    ('Python', '2.7.12'),
    ('graphviz', '0.5.1', '-Python-%(pyver)s'),
    ('OpenCV', '3.1.0'),
]

preconfigopts = ['cp make/config.mk . &&']

files_to_copy = [(['lib/libmxnet.a', 'lib/libmxnet.%s' % SHLIB_EXT], 'lib'),]

sanity_check_paths = {
    'files': ['lib/libmxnet.%s' % SHLIB_EXT],
    'dirs': [],
}

moduleclass = 'math'
