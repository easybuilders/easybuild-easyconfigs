# Based on the work from PR #22700 and #22422

easyblock = 'PythonPackage'

name = 'FEniCS-DOLFINx-Python'
version = '0.10.0'

homepage = 'https://docs.fenicsproject.org/dolfinx/main/python/'
description = """
DOLFINx is the next generation problem solving interface of the FEniCS Project - Python binding.
"""

toolchain = {'name': 'foss', 'version': '2025b'}

source_urls = ['https://github.com/FEniCS/dolfinx/archive/refs/tags/']
sources = [f'v{version}.post1.tar.gz']
checksums = ['43ebfaf89fcb7809b11b94ba3e8ea8e56a99d724a45c51e99e39a35c577c441e']

builddependencies = [
    ('pkgconfig', '1.5.5', '-python'),
    ('scikit-build-core', '0.11.5'),
    ('nanobind', '2.9.2'),
]

dependencies = [
    ('Python', '3.13.5'),
    ('SciPy-bundle', '2025.07'),
    ('petsc4py', '3.24.0'),
    ('mpi4py', '4.1.0'),
    ('slepc4py', '3.24.0'),
    ('FEniCS-Basix-Python', '0.10.0'),
    ('FEniCS-FFCx', '0.10.0'),
    ('FEniCS-UFL', '2025.2.0'),
    ('FEniCS-DOLFINx', '%(version)s'),
]

install_src = './python'

options = {'modulename': False}

sanity_check_commands = [
    'mpiexec -N 1 python -c "from mpi4py import MPI; import dolfinx"',
]

moduleclass = 'cae'
