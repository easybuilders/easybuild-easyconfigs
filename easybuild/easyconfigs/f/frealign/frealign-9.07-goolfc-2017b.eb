easyblock = 'MakeCp'

name = 'frealign'
version = '9.07'

homepage = 'http://grigoriefflab.janelia.org/frealign'
description = """Frealign is a program for high-resolution refinement of 3D reconstructions from cryo-EM images of
 single particles."""

toolchain = {'name': 'goolfc', 'version': '2017b'}
toolchainopts = {'pic': True}

source_urls = ['http://grigoriefflab.janelia.org/sites/default/files/']
sources = ['frealign_v%(version)s_140422.tar.gz']
patches = [
    'frealign-9.07_fix_makefiles.patch',
    'frealign-9.11_fix_missing_ctype_include.patch',
]

start_dir = 'src'

parallel = 1

# clean all binaries that will be rebuilt first
prebuildopts = "rm -f ../bin/*.exe && "
buildopts = "-f Makefile_linux_amd64_gnu"

files_to_copy = ['bin']

sanity_check_paths = {
    'files': ['bin/rsample.exe', 'bin/calc_occ.exe', 'bin/frealign_v%(version_major)s.exe'],
    'dirs': [],
}

moduleclass = 'vis'
