easyblock = 'PythonBundle'

name = 'Flax'
version = '0.10.2'
versionsuffix = '-CUDA-%(cudaver)s'

homepage = 'https://flax.readthedocs.io'
description = """Flax is a high-performance neural network library and ecosystem for JAX that is
designed for flexibility: Try new forms of training by forking an example and
by modifying the training loop, not by adding features to a framework."""

toolchain = {'name': 'gfbf', 'version': '2024a'}

builddependencies = [('hatchling', '1.24.2')]
dependencies = [
    ('CUDA', '12.6.0', '', SYSTEM),
    ('Python', '3.12.3'),
    ('SciPy-bundle', '2024.05'),
    ('jax', '0.6.2', versionsuffix),
    ('Optax', '0.2.4', versionsuffix),
    ('protobuf-python', '5.28.0'),
    ('PyYAML', '6.0.2'),
    ('tensorstore', '0.1.72'),
]

exts_list = [
    ('nest_asyncio', '1.6.0', {
        'checksums': ['6f172d5449aca15afd6c646851f4e31e02c598d553a667e38cafa997cfec55fe'],
    }),
    ('humanize', '4.11.0', {
        'checksums': ['e66f36020a2d5a974c504bd2555cf770621dbdbb6d82f94a6857c0b1ea2608be'],
    }),
    ('orbax_checkpoint', version, {
        'modulename': 'orbax.checkpoint',
        'checksums': ['e575ebe1f94e5cb6353ab8c9df81de0ca7cddc118645c3bfc17b8344f19d42f1'],
    }),
    ('%(namelower)s', version, {
        'checksums': ['6f831350026ad48182ba6588bb4dd72dc1084985d9aca923254cb3e4c78d75f3'],
    }),
]

moduleclass = 'ai'
