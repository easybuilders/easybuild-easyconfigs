easyblock = 'ConfigureMake'

name = 'libs3'
# major/minor version based on LIBS3_VER_* in GNUmakefile
version = '4.1-20190410'
local_commit = '287e4be'

homepage = 'https://github.com/bji/libs3'
description = """This package includes the libs3 shared object library, needed to run
                 applications compiled against libs3, and additionally contains the s3
                 utility for accessing Amazon S3."""

toolchain = {'name': 'GCCcore', 'version': '13.2.0'}

source_urls = ['https://github.com/bji/libs3/archive']
sources = [{'download_filename': f'{local_commit}.tar.gz', 'filename': SOURCE_TAR_GZ}]
checksums = ['8218d82f034269ec11eeca96464fb4202027286175b93cf3f1847b650377efd9']

builddependencies = [
    ('binutils', '2.40'),
]

dependencies = [
    ('libxml2', '2.11.5'),
    ('cURL', '8.3.0'),
]

skipsteps = ['configure']

preinstallopts = 'DESTDIR=%(installdir)s '

sanity_check_paths = {
    'files': ['bin/s3', 'include/libs3.h', 'lib/libs3.a', 'lib/libs3.%s' % SHLIB_EXT],
    'dirs': ['bin', 'include', 'lib']
}

moduleclass = 'data'
