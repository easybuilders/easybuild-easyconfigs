easyblock = 'ConfigureMake'

name = 'LuaJIT'
version = '2.1.ROLLING'

_commit = '2090842'

homepage = "https://luajit.org/"
description = """LuaJIT is a Just-In-Time Compiler (JIT) for the Lua
programming language. Lua is a powerful, dynamic and light-weight programming
language. It may be embedded or used as a general-purpose, stand-alone
language. """

toolchain = {'name': 'GCC', 'version': '12.3.0'}

# Releases are only made occasionally. You're strongly encouraged to follow the git branches.
sources = [{

    'source_urls': ['https://github.com/LuaJIT/LuaJIT/archive/refs/tags'],
    'download_filename': 'v%s.tar.gz' % version,
    'filename': SOURCE_TAR_GZ,
}]
checksums = ['31d7a4853df4c548bf91c13d3b690d19663d4c06ae952b62606c8225d0b410ad']

dependencies = [('ncurses', '6.4')]

skipsteps = ['configure']
installopts = 'PREFIX=%(installdir)s'

postinstallcmds = ['cd %%(installdir)s/bin && mv luajit-2.1. luajit-2.1.ROLLING && ln -s luajit-%s luajit' % version]

sanity_check_paths = {
    'files': ["bin/luajit"],
    'dirs': [],
}

sanity_check_commands = ['luajit -v']

moduleclass = "lang"
