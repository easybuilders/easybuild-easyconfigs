easyblock = 'ConfigureMake'

name = 'libsc'
version = '2.8'

homepage = 'https://github.com/cburstedde/libsc'
description = """ The SC Library provides support for parallel scientific
applications."""

toolchain = {'name': 'gmpich', 'version': '2017.08'}
toolchainopts = {'optarch': False, 'usempi': True}

source_urls = ['https://github.com/cburstedde/libsc/archive']
sources = ['v%(version)s.tar.gz']
patches = ['libsc-2.x_m4-files.patch']
checksums = [
    'fbfa61da6724c4606a8e93578404e7c935bc6371092e61dd369a81e207785dfa',  # v2.8.tar.gz
    'fcf1ab69e121c29a55faf2ab0b8b836f19aac0f02a4566f4fffb6cf07a001a18',  # libsc-2.x_m4-files.patch
]

builddependencies = [
    ('Autotools', '20170619')
]

preconfigopts = 'echo "%(version)s" >> .tarball-version && ./bootstrap && '
configopts = '--enable-mpi --enable-pthreads --enable-openmp '
configopts += '--without-blas --without-lapack '
runtest = 'check'


sanity_check_paths = {
    'files': ['bin/sc_b64dec', 'bin/sc_test_shmem',
              'lib/libsc-%%(version)s.%s' % SHLIB_EXT],
    'dirs': []
}

moduleclass = 'math'
