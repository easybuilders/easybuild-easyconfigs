easyblock = 'PythonBundle'

name = 'LINC'
version = '5.0'

homepage = "https://linc.readthedocs.io/en/latest/"

description = """
LINC is a pipeline to correct for various instrumental and ionospheric effects in both LOFAR HBA and LOFAR LBA observations.
"""

toolchain = {'name': 'foss', 'version': '2023b'}

builddependencies = [
    ('CMake', '3.27.6'),
    ('scikit-build', '0.17.6'),
]

# Based on https://git.astron.nl/RD/LINC/-/tree/releases/v5.0?ref_type=heads#software-requirements
dependencies = [
    ('Boost', '1.83.0'),
    ('Boost.Python-NumPy', '1.83.0'),  # Boost_numpy is required for bdsf
    ('DP3', '6.2'),
    ('LoSoTo', '2.5.0'),
    ('LSMTool', '1.7.0'),
    ('EveryBeam', '0.6.1'),  # Should be 0.6.2 or newer according to the docs?
    ('SAGECal', '0.8.4'),
    ('RMextract', '0.5.1'),
    ('AOFlagger', '3.4.0'),
    ('WSClean', '3.5'),
    ('IDG', '1.2.0',),
    ('LofarStMan', '1.0'),
    ('dysco', '1.3'),
    ('Python', '3.11.5'),
    ('Python-bundle-PyPI', '2023.10'),
    ('SciPy-bundle', '2023.11'),
    ('matplotlib', '3.8.2'),
    ('python-casacore', '3.5.2'),
    ('astropy', '7.0.0'),
    ('h5py', '3.11.0'),
    ('cwltool', '3.1.20250110105449'),
    ('toil-cwl', '8.2.0'),
]

exts_list = [
    ('pyregion', '2.3.0', {
        'checksums': ['e8498711421173239689de523bb465245f5551a18a181cb4956d87f9c7464925'],
    }),
    ('backports.shutil_get_terminal_size', '1.0.0', {
        'checksums': ['713e7a8228ae80341c70586d1cc0a8caa5207346927e23d09dcbcaf18eadec80'],
    }),
    ('bdsf', '1.13.0.post2', {
        'checksums': ['2a91647fcdb1f6574958312d85decd4529a10e710926f11300a2388f4c9e25cd'],
    }),
    (name, version, {
        'modulename': False,
        'sources': [{
            'filename': '%(name)s-v%(version)s.tar.xz',
            'git_config': {
                'url': 'https://git.astron.nl/RD/',
                'repo_name': 'LINC',
                'commit': 'v%(version)s',
                'recursive': True,
                'keep_git_dir': True
            }
        }],
        'checksums': ['2d81f222ab68f075075e0c771540508c535ea128b0a8c7b8d44f11fbfd89f40e'],
    }),
]

moduleclass = 'astro'
