name = 'ROOT'
version = '6.24.06'

homepage = 'https://root.cern.ch/drupal/'
description = """The ROOT system provides a set of OO frameworks with all the functionality
    needed to handle and analyze large amounts of data in a very efficient way."""

toolchain = {'name': 'foss', 'version': '2021a'}
toolchainopts = {'pic': True, 'extra_cxxflags': '-std=c++17'}

source_urls = ['https://root.cern.ch/download/']
sources = ['%(namelower)s_v%(version)s.source.tar.gz']
patches = ['ROOT-6.14.06_fix-VDT-target.patch']
checksums = [
    '907f69f4baca1e4f30eeb4979598ca7599b6aa803ca046e80e25b6bbaa0ef522',  # root_v6.24.06.source.tar.gz
    'ff51eb823726d146840b149945b7896b8e60cc0920933b740d780a540b62e4d8',  # ROOT-6.14.06_fix-VDT-target.patch
]

builddependencies = [
    ('CMake', '3.20.1'),
    ('pkg-config', '0.29.2'),
]
dependencies = [
    ('GSL', '2.7'),
    ('libxml2', '2.9.10'),
    ('PCRE', '8.44'),
    ('CFITSIO', '4.0.0'),
    ('freetype', '2.10.4'),
    ('Python', '3.9.5'),
    ('zlib', '1.2.11'),
    ('X11', '20210518'),
    ('Mesa', '21.1.1'),
    ('libGLU', '9.0.1'),
    ('GL2PS', '1.4.2'),
    ('FFTW', '3.3.9'),
    ('SQLite', '3.35.4'),
    ('XZ', '5.2.5'),
    ('libpng', '1.6.37'),
]


# see https://root.cern/install/build_from_source/#all-build-options for the full list of options
# maximem 13-12-2021: some of the default options make the build fail, but I could not identify precisely which one(s). Starting from a minimal build I managed to get a working install
configopts = " -Dminimal=ON -Dpyroot=ON"

# NOTE: Ensure that each configopts string begins with a blank
# disable some components
configopts += " -Dxrootd=OFF -Dmysql=OFF -Dkrb5=OFF -Dodbc=OFF -Doracle=OFF -Dpgsql=OFF -Dqt=OFF"

# make sure some components are enabled
configopts += " -Dpython3=ON -Dpcre=ON -Dzlib=ON"
configopts += " -Dunuran=ON -Dexplicitlink=ON -Dminuit2=ON -Droofit=ON "

# Add component-specific settings based on dependencies
configopts += " -Dfftw3=ON -Dgsl=ON -DOpenGL_GL_PREFERENCE=GLVND "

# Build with C++17 standard
configopts += " -Dcxx17=ON "
#configopts += " -DCMAKE_CXX_STANDARD=14 -Dcxx14=ON "

moduleclass = 'data'
