# Author: Pavel Grochal (INUITS)
# License: GPLv2

easyblock = 'PythonBundle'

name = 'rpy2'
version = '3.4.5'

homepage = 'https://rpy2.bitbucket.io/'
description = """rpy2 is an interface to R running embedded in a Python process."""

toolchain = {'name': 'foss', 'version': '2020b'}

dependencies = [
    ('Python', '3.8.6'),
    ('R', '4.0.3'),
    ('IPython', '7.18.1'),
]

use_pip = True
sanity_pip_check = True

exts_list = [
    ('simplegeneric', '0.8.1', {
        'source_tmpl': '%(name)s-%(version)s.zip',
        'checksums': ['dc972e06094b9af5b855b3df4a646395e43d1c9d0d39ed345b7393560d0b9173'],
    }),
    ('tzlocal', '4.1', {
    }),
    ('cffi', '1.15.0', {
    }),
    ('tzdata', '2021.5', {
    }),
    ('backports-zoneinfo', '0.2.1', {
        'source_tmpl': 'backports.zoneinfo-%(version)s.tar.gz',
        'modulename': 'backports.zoneinfo',
    }),
    ('pytz-deprecation-shim', '0.1.0.post0', {
        'source_tmpl': 'pytz_deprecation_shim-%(version)s.tar.gz'
    }),
    (name, version, {
    }),
]

# sanity_check_commands = [
#     "pytest --pyargs rpy2 "
#     # Disable tests which requires X11 present othewise it crashes with
#     # "unable to open connection to X11 display" error
#     "--ignore=lib/python3.8/site-packages/rpy2/tests/ipython/test_rmagic.py "
#     "--ignore=lib/python3.8/site-packages/rpy2/tests/robjects/lib/test_grdevices.py "
# ]

moduleclass = 'tools'
