easyblock = 'CMakeMake'

name = 'RELION'
version = '2.0.1'
commit_id = 'a6225608e270'
cuda = 'CUDA'
cuver = '7.5.18'
versionsuffix = '-%s-%s' % (cuda, cuver)

homepage = 'http://www2.mrc-lmb.cam.ac.uk/relion/index.php/Main_Page'
description = """RELION (for REgularised LIkelihood OptimisatioN, pronounce rely-on) is a stand-alone computer
 program that employs an empirical Bayesian approach to refinement of (multiple) 3D reconstructions or 2D class
 averages in electron cryo-microscopy (cryo-EM)."""

toolchain = {'name': 'foss', 'version': '2016a'}
toolchainopts = {'opt': True}

source_urls = ['https://bitbucket.org/tcblab/relion2-beta/get/']
sources = ['%s.tar.gz' % commit_id]

patches = ['RELION-%(version)s_cmake.patch']

builddependencies = [
    ('CMake', '3.4.3'),
    ('xproto', '7.0.28'),
]

dependencies = [
    (cuda, cuver,'' ,True),
    ('libX11', '1.6.3'),
    ('libXcursor', '1.1.14'),
    ('libXinerama', '1.1.3'),
    ('libXfixes', '5.0.1'),
    ('libXext', '1.3.3'),
    ('libXrender', '0.9.9'),
    ('libXau', '1.0.8'),
    ('FLTK', '1.3.3'),
]

moduleclass = 'bio'
