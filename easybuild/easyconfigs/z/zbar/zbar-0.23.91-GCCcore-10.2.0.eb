# Contribution from the NIHR Biomedical Research Centre
# Guy's and St Thomas' NHS Foundation Trust and King's College London
# uploaded by J. Sassmannshausen

easyblock = 'ConfigureMake'

name = 'zbar'
version = '0.23.91'

homepage = 'https://github.com/mchehab/zbar'
description = """ZBar is an open source software suite for reading bar codes
from various sources, including webcams. As its development stopped in 2012,
I took the task of keeping it updated with the V4L2 API. This is the main
repository for it. There's a clone at at LinuxTV.org, and another one at gitlab."""

toolchain = {'name': 'GCCcore', 'version': '10.2.0'}

source_urls = ['https://github.com/mchehab/zbar/archive/']
sources = ['%(version)s.tar.gz']
checksums = ['69f3efe1350293552c961fe987573691bf6fb44c04f002b9456f0fd5e8e037cf']  # 0.23.91.tar.gz

builddependencies = [
    ('binutils', '2.35'),
    ('Autotools', '20200321'),
    ('pkg-config', '0.29.2'),
]

dependencies = [
    ('Python', '3.8.6'),
    ('GTK+', '3.24.23'),
    ('ImageMagick', '7.0.10-35'),
    ('X11', '20201008'),
    ('Java', '11', '', SYSTEM),
    ('Qt5', '5.14.2'),
]

configure_cmd_prefix = "autoreconf -vfi && "
#
# uncomment if you want don't want to build the documents
# configopts = "--disable-doc --with-gtk=auto --with-python=auto"
osdependencies = ['xmlto']
configopts = " --with-gtk=auto --with-python=auto"

sanity_check_paths = {
    'files': ['bin/zbarcam', 'bin/zbarcam-gtk', 'bin/zbarimg',
              'lib/libzbar.%s' % SHLIB_EXT, 'lib/libzbargtk.%s' % SHLIB_EXT],
    'dirs': ['include/zbar', 'lib/pkgconfig', 'share/zbar/lib'],
}

moduleclass = 'vis'
