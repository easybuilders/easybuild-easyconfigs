name = 'HPCToolkit'
version = '5.3.2'

homepage = 'http://hpctoolkit.org/'
description = """HPCToolkit is an integrated suite of tools for measurement and analysis of program performance
 on computers ranging from multicore desktop systems to the nation's largest supercomputers."""

toolchain = {'name': 'dummy', 'version': ''}  # empty version to make sure dependencies are loaded

rev = 'r4197'
source_urls = [GOOGLECODE_SOURCE]
sources = [
    '%%(namelower)s-%%(version)s-%s.tar.gz' % rev,
    '%%(namelower)s-externals-%%(version)s-%s.tar.gz' % rev,
]

dependencies = [
    ('Boost', '1.47.0', '', True),
    ('PAPI', '5.3.0'),
]

start_dir = "%%(builddir)s/%%(namelower)s-%%(version)s-%s" % rev
preconfigopts = "mkdir -p %(installdir)s/externals && cp -a ../hpctoolkit-externals-*/* %(installdir)s/externals && cd %(installdir)s/externals && "
preconfigopts += "./configure --with-boost=$EBROOTBOOST && make && cd - && "
configopts = "--with-externals=%(installdir)s/externals --with-papi=$EBROOTPAPI"

keeppreviousinstall = True

sanity_check_paths = {
    'files': ['bin/hpc%s' % x for x in ['link', 'prof', 'run', 'struct', 'summary']] + ['include/hpctoolkit.h'],
    'dirs': ['lib/hpctoolkit'],
}

moduleclass = 'tools'
