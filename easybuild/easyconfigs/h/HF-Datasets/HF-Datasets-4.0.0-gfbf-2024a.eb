easyblock = "PythonBundle"

name = 'HF-Datasets'
version = '4.0.0'

homepage = 'https://github.com/huggingface/datasets'
description = """
The largest hub of ready-to-use datasets for ML models with fast, easy-to-use and efficient
data manipulation tools.
"""

toolchain = {'name': 'gfbf', 'version': '2024a'}

dependencies = [
    ('Python', '3.12.3'),
    ('SciPy-bundle', '2024.05'),
    ('aiohttp', '3.10.10'),
    ('Arrow', '17.0.0'),
    ('dill', '0.3.9'),
    ('huggingface_hub', '0.34.4'),
    ('multiprocess', '0.70.17'),
    ('python-xxhash', '3.5.0'),
    ('PyYAML', '6.0.2'),
    ('tqdm', '4.66.5'),
]

# fake pinning due to old issue, 'datasets' pushes the max pinned version of 'dill' on every release
_fix_pins = """sed -i s'/dill>=0.3.0.*",/dill>=0.3.0",/' setup.py && """
# unlocking dill allows to unlock multiprocess
_fix_pins += """sed -i s'/multiprocess.*",/multiprocess",/' setup.py && """

exts_list = [
    ('datasets', version, {
        'preinstallopts': _fix_pins,
        'checksums': ['9657e7140a9050db13443ba21cb5de185af8af944479b00e7ff1e00a61c8dbf1'],
    }),
]

moduleclass = 'data'
