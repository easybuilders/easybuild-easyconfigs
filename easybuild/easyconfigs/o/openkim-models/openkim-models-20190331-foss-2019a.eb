easyblock = 'CMakeMake'

name = 'openkim-models'
version = '20190331'

homepage = 'https://openkim.org/'
description = """Open Knowledgebase of Interatomic Models.

OpenKIM is an API and a collection of interatomic models (potentials) for
atomistic simulations.  It is a library that can be used by simulation programs
to get access to the models in the OpenKIM database.

This EasyBuild installs the models.  The API itself is in the kim-api
package.
 """

toolchain = {'name': 'foss', 'version': '2019a'}

builddependencies = [
    ('pkgconfig', '1.5.1', '-python'),
]

dependencies = [
    ('kim-api', '2.0.2'),
]

source_urls = ['https://s3.openkim.org/archives/collection/']
sources = ['openkim-models-2019-03-31.txz']
checksums = ['12a59f24e8ebf42627b4c33329e1f631d9f1ad96cb0bbf847276f3c8380d7063']

separate_build_dir = True
abs_path_compilers = True   # Otherwise some KIM-API magic breaks cmake.
configopts = '-DKIM_API_INSTALL_COLLECTION=SYSTEM '
configopts += '-DKIM_API_MODEL_INSTALL_PREFIX=%(installdir)s/lib/kim-api/models '
configopts += '-DKIM_API_MODEL_DRIVER_INSTALL_PREFIX=%(installdir)s/lib/kim-api/model-drivers '

sanity_check_paths = {
    'files': [],
    'dirs': ['lib/kim-api/model-drivers', 'lib/kim-api/models']
}

modextravars = {
    'KIM_API_MODEL_DRIVERS_DIR': '%(installdir)s/lib/kim-api/model-drivers',
    'KIM_API_MODELS_DIR': '%(installdir)s/lib/kim-api/models'
}


moduleclass = 'chem'
