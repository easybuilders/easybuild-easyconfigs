easyblock = 'PythonBundle'

name = 'Optax'
version = '0.2.4'
versionsuffix = '-CUDA-%(cudaver)s'

homepage = 'https://github.com/deepmind/optax'
description = """Optax is a gradient processing and optimization library for JAX."""

toolchain = {'name': 'gfbf', 'version': '2024a'}

dependencies = [
    ('CUDA', '12.6.0', '', SYSTEM),
    ('Python', '3.12.3'),
    ('SciPy-bundle', '2024.05'),
    ('jax', '0.4.35', versionsuffix),
]

exts_list = [
    ('toolz', '0.12.1', {
        'checksums': ['ecca342664893f177a13dac0e6b41cbd8ac25a358e5f215316d43e2100224f4d'],
    }),
    ('chex', '0.1.88', {
        'checksums': ['565de897b1373232cdfca5e699f50fa49403d2c7d23f6c5a75a97ef713d2fe36'],
    }),
    ('optax', version, {
        'checksums': ['4e05d3d5307e6dde4c319187ae36e6cd3a0c035d4ed25e9e992449a304f47336'],
    }),
]

sanity_check_commands = ["python -c 'from optax import GradientTransformation'"]

moduleclass = 'lib'
