easyblock = 'PythonBundle'

name = 'Optax'
version = '0.2.4'
versionsuffix = '-CUDA-%(cudaver)s'

homepage = 'https://github.com/deepmind/optax'
description = """Optax is a gradient processing and optimization library for JAX."""

toolchain = {'name': 'gfbf', 'version': '2024a'}

dependencies = [
    ('CUDA', '12.6.0', '', SYSTEM),
    ('Python', '3.12.3'),
    ('SciPy-bundle', '2024.05'),
    ('jax', '0.4.35', versionsuffix),
]

exts_list = [
    ('chex', '0.1.87', {
        'checksums': ['0096d89cc8d898bb521ef4bfbf5c24549022b0e5b301f529ab57238896fe6c5d'],
    }),
    ('toolz', '1.0.0', {
        'checksums': ['2c86e3d9a04798ac556793bced838816296a2f085017664e4995cb40a1047a02'],
    }),
    ('optax', version, {
        'checksums': ['4e05d3d5307e6dde4c319187ae36e6cd3a0c035d4ed25e9e992449a304f47336'],
    }),
]

sanity_check_commands = ["python -c 'from optax import GradientTransformation'"]

moduleclass = 'lib'
