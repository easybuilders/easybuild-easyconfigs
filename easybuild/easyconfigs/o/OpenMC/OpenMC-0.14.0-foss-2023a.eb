##
# This file is an EasyBuild reciPY as per https://github.com/easybuilders/easybuild
#
# Copyright:: Â© Copyright 2011-2023, Massachusetts Institute of Technology, 
# 		UChicago Argonne LLC, and OpenMC contributors
#             HPCNow!
# Authors::   Guillermo Piccoli <guillermo.piccoli@hpcnow.com>
# License::   MIT
##

easyblock = 'CMakeMake'

name = 'OpenMC'
version = '0.14.0'

homepage = 'https://github.com/openmc-dev/openmc'
description = """OpenMC is an open-source Monte Carlo particle transport simulation code."""

toolchain = {'name': 'foss', 'version': '2023a'}

dependencies = [
    ('HDF5', '1.14.3'),
    ('pugixml', '1.14'),
    ('gsl-lite', '0.41.0'),
    ('xtensor', '0.25.0'),
    ('fmt', '10.2.1'),
    ('Catch2', '3.5.3')
]

builddependencies = [
    ('CMake', '3.28.3')
]

source_urls = ['https://github.com/openmc-dev/openmc/archive/refs/tags']
sources = ['v%(version)s.tar.gz']

preconfigopts = "touch %(builddir)s/openmc-0.14.0/vendor/pugixml/CMakeLists.txt %(builddir)s/openmc-0.14.0/vendor/gsl-lite/CMakeLists.txt && "

configopts = "-DHDF5_PREFER_PARALLEL=on " \
             "-DOPENMC_USE_MPI=on " \
             "-DGIT_SUBMODULE=OFF "

sanity_check_paths = {
    'files': [
	'%(installdir)s/bin/openmc',
        '%(installdir)s/lib/libopenmc.so',
    ],
    'dirs': [
	'bin', 
	'include/openmc', 
	'lib', 
    ]
}

moduleclass = 'tools'
