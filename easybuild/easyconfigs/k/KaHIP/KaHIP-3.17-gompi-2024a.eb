# METIS support added
# Author: J. Sa√ümannshausen (Imperial College London/UK)

easyblock = 'CMakeMake'

name = 'KaHIP'
version = '3.17'

homepage = 'https://kahip.github.io/'
description = """The graph partitioning framework KaHIP --
Karlsruhe High Quality Partitioning."""

toolchain = {'name': 'gompi', 'version': '2024a'}
toolchainopts = {'pic': True}

source_urls = ['https://github.com/KaHIP/KaHIP/archive/refs/tags']
sources = ['v%(version)s.tar.gz']
checksums = ['ced8745d30ed60c178c55f14f4c17d657c3b91f9efdd876284b2552bb4e2bb8e']

builddependencies = [
    ('CMake', '3.29.3'),
]

dependencies = [
    ('GKlib-METIS', '5.1.1'),
    ('METIS', '5.1.0'),
    ('gperftools', '2.16'),
]

configopts = '-DUSE_TCMALLOC=ON '

sanity_check_paths = {
    'files': ["lib/libkahip_static.a", f"lib/libkahip.{SHLIB_EXT}"] +
             ["lib/libparhip_interface_static.a", f"lib/libparhip_interface.{SHLIB_EXT}"] +
             ["include/%s" % x for x in ["kaHIP_interface.h", "parhip_interface.h"]],
    'dirs': [],
}

moduleclass = 'math'
