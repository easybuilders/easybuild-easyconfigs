# Contribution from the NIHR Biomedical Research Centre
# Guy's and St Thomas' NHS Foundation Trust and King's College London
# uploaded by J. Sassmannshausen
# we recommend to use --download-timeout=1000 when fetching the files

easyblock = 'CmdCp'

name = 'BGEN'
version = '1.1.7'

homepage = 'https://enkre.net/cgi-bin/code/bgen/dir?ci=trunk'
description = """This repository contains a reference implementation 
of the BGEN format, written in C++. The library can be used as the 
basis for BGEN support in other software, or as a reference for 
developers writing their own implementations of the BGEN format.
Please cite:
Band, G. and Marchini, J., "BGEN: a binary file format for imputed genotype and haplotype data", 
bioArxiv 308296; doi: https://doi.org/10.1101/308296
"""

toolchain = {'name': 'GCCcore', 'version': '10.3.0'}

source_urls = ['https://code.enkre.net/bgen/tarball/release/']
sources = [{'download_filename': '%(namelower)s.tgz', 'filename': '%(version)s.tgz'}]
checksums = [
    '22a5e9254b71a08f233779350472f03c6f32a60cb6e07750305a9115454d7470'  # 1.1.7.tgz
]

cmds_map = [
    ('.*', "./waf configure && ./waf"),
]

files_to_copy = [(['build/apps/edit-bgen', 'build/apps/bgenix', 'build/apps/cat-bgen'], 'bin')]

runtest = './build/test/unit/test_bgen && ./build/apps/bgenix -g example/example.16bits.bgen -list'

sanity_check_paths = {
    'files': ['bin/bgenix'],
    'dirs': [''],
}

moduleclass = 'bio'
