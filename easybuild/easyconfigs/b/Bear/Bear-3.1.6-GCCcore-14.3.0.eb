easyblock = 'CMakeMake'

name = 'Bear'
version = '3.1.6'

homepage = 'https://github.com/rizsotto/Bear'
description = """
Bear is a tool that generates a compilation database for clang tooling.

The JSON compilation database is used in the clang project to provide
information on how a single compilation unit is processed. With this, it is
easy to re-run the compilation with alternate programs.

Some build system natively supports the generation of JSON compilation
database. For projects which does not use such build tool, Bear generates
the JSON file during the build process.
"""

toolchain = {'name': 'GCCcore', 'version': '14.3.0'}

github_account = 'rizsotto'
source_urls = [GITHUB_SOURCE]
sources = [{'download_filename': '%(version)s.tar.gz', 'filename': SOURCE_TAR_GZ}]
checksums = ['99cd891eec6e89b734d7cafe0e623dd8c2f27d8cbf3ee9bc4807e69e5c8fb55c']

builddependencies = [
    ('binutils', '2.44'),
    ('CMake', '4.0.3'),
    ('googletest', '1.17.0'),
]

dependencies = [
    ('gRPC', '1.76.0'),
    ('fmt', '11.2.0'),
    ('nlohmann_json', '3.12.0'),
    ('spdlog', '1.15.3'),
]

sanity_check_paths = {
    'files': ['bin/bear', 'lib/bear/wrapper'],
    'dirs': ['share/man', 'share/doc/Bear'],
}

sanity_check_commands = [
    "%(namelower)s --version | grep %(version)s",
]

moduleclass = 'tools'
