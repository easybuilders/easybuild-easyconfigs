easyblock = 'CMakeMake'

name = 'BCL'
version = '4.3.0'
versionsuffix = '-Python-%(pyver)s'

homepage = 'http://www.meilerlab.org/index.php/bclcommons/show/b_apps_id/1'
description = """The Bio Chemical Library (BCL) is a software package that provides unique tools for biological
research, such as protein structure determination from sparse experimental data. The BCL contains the widely used
secondary structure prediction program JUFO, a folding algorithm that assembles secondary structure elements, and
loop construction tools that complete protein backbones."""

toolchain = {'name': 'GCCcore', 'version': '11.2.0'}

github_account = "BCLCommons"
source_urls = [GITHUB_SOURCE]
sources = [{
    # The filename will probably change to a versioned name next release
    'download_filename': 'public_opening.tar.gz',
    'filename': 'v%(version)s.tar.gz',
}]
checksums = ['3416f513e4949fd218f1ccb6fd7cc0030afa3ac5c3b6cf9376a19a0c6622e74d']

builddependencies = [
    ('CMake', '3.22.1'),
    ('binutils', '2.37'),
]

dependencies = [
    ('bzip2', '1.0.8'),
    ('libglvnd', '1.3.3'),
    ('Python', '2.7.18'),
    ('zlib', '1.2.11'),
]

separate_build_dir = False

preconfigopts = "export BUILD_TYPE_ALIAS=release && "
preconfigopts += "python2 ./cmake/scripts/CheckCmakeLists.py ./ -o && "
preconfigopts += "python2 ./scripts/code/CreateNamespaceForwardHeaders.py ./ -o && "

sanity_check_paths = {
    'files': ['bin/bcl-apps.exe', 'bin/bcl-apps-static.exe', 'lib/libbcl.so'],
    'dirs': ['bin', 'lib'],
}
sanity_check_commands = ['bcl-apps.exe all:Help']

moduleclass = 'bio'
