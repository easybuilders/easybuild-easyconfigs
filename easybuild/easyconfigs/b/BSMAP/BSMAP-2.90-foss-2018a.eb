easyblock = 'ConfigureMake'

name = 'BSMAP'
version = '2.90'

homepage = 'https://code.google.com/p/bsmap/'
description = """BSMAP is a short reads mapping software for bisulfite sequencing reads."""

toolchain = {'name': 'foss', 'version': '2018a'}

source_urls = ['http://lilab.research.bcm.edu/dldcc-web/lilab/yxi/bsmap/']
sources = [SOURCELOWER_TGZ]
checksums = ['8b5ae4ba404e898adac14b0338c88455f882bee556a92d269de87c993f007ac2']

skipsteps = ['configure']

installopts = "BIN=%(installdir)s/bin"

# patches = [
#     'BSMAP-2.74_makefile-modif.patch',
#     'BSMAP-2.74_parameters-cpp.patch',
#     'BSMAP-2.74_samtools-deps.patch',
# ]

dependencies = [
    ('ncurses', '6.0'),
    ('zlib', '1.2.11'),
    ('SAMtools', '1.7', '-HTSlib-1.7'),
    ('Python', '2.7.14'),
]

postinstallcmds = ['sed -i"" "s@samtools/@@g" %(installdir)s/bin/sam2bam.sh']

sanity_check_paths = {
    'files': ["bin/%s" % x for x in ["bsmap", "methratio.py", "sam2bam.sh"]],
    'dirs': [],
}

moduleclass = 'data'
