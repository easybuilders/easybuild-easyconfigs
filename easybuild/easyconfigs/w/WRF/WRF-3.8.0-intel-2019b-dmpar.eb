name = 'WRF'
version = '3.8.0'
buildtype = "dmpar"
versionsuffix = '-%s' % buildtype

homepage = 'https://www.mmm.ucar.edu/weather-research-and-forecasting-model'
description = """The Weather Research and Forecasting (WRF) Model is a next-generation mesoscale
 numerical weather prediction system designed to serve both operational forecasting and atmospheric
 research needs."""

toolchain = {'name': 'intel', 'version': '2019b'}
toolchainopts = {'opt': False}  # don't use agressive optimization, stick to -O2

source_urls = [
    'https://www2.mmm.ucar.edu/wrf/src/',
    'https://www.mmm.ucar.edu/wrf/src/',
]
sources = ['%(name)sV%(version_major_minor)s.TAR.gz']
patches = [
    'WRF_parallel_build_fix.patch',
    'WRF_tests_limit-runtimes.patch',
    'WRF-%(version)s_netCDF-Fortran_separate_path.patch',
    'WRF-%(version)s_known_problems.patch',
    'WRF-%(version)s_libtirpc.patch',
]
checksums = [
    'fa331c0e94a52d39a4c7d644509057491b1341dd9e11bfe0596d6f0cb16756a0',  # WRFV3.8.TAR.gz
    'f93bb6dbb8b52d72f816e2f9a6815bffd536afeca8511552ec5abc4253a59346',  # WRF_parallel_build_fix.patch
    '9f6bbf01f39adaf0c83a4bcda9719929d7779a4aaba2c186ed32b4ddcf6d0fc6',  # WRF_tests_limit-runtimes.patch
    'd7223ffd8ff2b7729f29850bd9149b31ef01f46fb4a67b3ba72496da5455ea4c',  # WRF-3.8.0_netCDF-Fortran_separate_path.patch
    '05afa8564ac26204e5138a06bc57b8e81bba158845d13cb5bb8b8faf993dac63',  # WRF-3.8.0_known_problems.patch
    'afd968f807191d6ed607f0486cda7053d7e87b05da0e987f3db030a4e97126a7',  # WRF-3.8.0_libtirpc.patch
]

# csh is used by WRF install scripts
builddependencies = [
    ('M4', '1.4.18'),
    ('tcsh', '6.22.02'),
    ('time', '1.9'),
]

dependencies = [
    ('libtirpc', '1.2.6'),
    ('JasPer', '2.0.14'),
    ('netCDF', '4.7.1'),
    ('netCDF-Fortran', '4.5.2'),
]

# limit parallel build to 20
maxparallel = 20

moduleclass = 'geo'
