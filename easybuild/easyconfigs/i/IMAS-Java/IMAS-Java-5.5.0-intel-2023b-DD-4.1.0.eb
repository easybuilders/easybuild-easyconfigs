easyblock = 'CMakeMake'

name = 'IMAS-Java'
version = '5.5.0'
local_dd_version = '4.1.0'
versionsuffix = f'-DD-{local_dd_version}'

github_account = 'iterorganization'

description = 'IMAS Access Layer Java High Level Interface'
homepage = 'https://github.com/iterorganization/IMAS-Java'

toolchain = {'name': 'intel', 'version': '2023b'}

builddependencies = [
    ('CMake', '3.27.6'),
    ('Saxon-HE', '12.9', '-Java-25', SYSTEM),
    ('IMAS-Data-Dictionary', local_dd_version),
]

dependencies = [
    ('Java', '25', '', SYSTEM),
    ('IMAS-Core', '5.5.2'),
    ('IMAS-MDSplus-models', '5.5.2', versionsuffix),
]

source_urls = [GITHUB_SOURCE]
sources = [{'download_filename': '%s.tar.gz' % version, 'filename': SOURCE_TAR_GZ}]
checksums = ['bcb990516d28d58d106477facff9536d6f02d1f22681d3c99dd2760e7d563fdc']

build_type = 'RelWithDebInfo'
configopts = (
    # Don't download dependencies
    '-D AL_DOWNLOAD_DEPENDENCIES=OFF '
    # Disable tests, examples and plugins
    '-D AL_TESTS=OFF '
    '-D AL_EXAMPLES=OFF '
    '-D AL_PLUGINS=OFF '
)

sanity_check_paths = {
    'dirs': ['lib', 'jar'],
    'files': [],
}

modextrapaths = {
    'CLASSPATH': 'jar/imas.jar',
}

moduleclass = 'tools'
