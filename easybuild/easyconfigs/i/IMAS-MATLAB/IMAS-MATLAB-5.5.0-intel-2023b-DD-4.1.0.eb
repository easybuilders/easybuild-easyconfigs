easyblock = 'CMakeMake'

name = 'IMAS-MATLAB'
version = '5.5.0'
local_dd_version = '4.1.0'
versionsuffix = f'-DD-{local_dd_version}'

github_account = 'iterorganization'

description = 'IMAS Access Layer MATLAB High Level Interface'
homepage = 'https://github.com/iterorganization/IMAS-Matlab'

toolchain = {'name': 'intel', 'version': '2023b'}

builddependencies = [
    ('CMake', '3.27.6'),
    ('Saxon-HE', '12.4', '-Java-21', SYSTEM),
    ('IMAS-Data-Dictionary', local_dd_version),
]

dependencies = [
    ('MATLAB', '2023b-r5'),
    ('IMAS-Core', '5.5.2'),
    ('IMAS-MDSplus-models', '5.5.2', versionsuffix),
]

source_urls = [GITHUB_SOURCE]
sources = [{'download_filename': '%s.tar.gz' % version, 'filename': SOURCE_TAR_GZ}]
checksums = ['213194fb02a93eddd17fa13f332adfdc6443cfd5cb2a65275dc3363bd8d8254b']

build_type = 'RelWithDebInfo'
configopts = (
    # Don't download dependencies
    '-D AL_DOWNLOAD_DEPENDENCIES=OFF '
    # Disable tests, examples and plugins
    '-D AL_TESTS=OFF '
    '-D AL_EXAMPLES=OFF '
    '-D AL_PLUGINS=OFF '
)

sanity_check_paths = {
    'dirs': ['lib', 'mex'],
    'files': [],
}

modextrapaths = {
    'MATLABPATH': 'mex',
}

moduleclass = 'tools'
