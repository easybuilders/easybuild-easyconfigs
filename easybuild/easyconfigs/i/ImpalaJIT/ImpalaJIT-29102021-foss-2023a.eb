# #
# This is a contribution from HPCNow! (http://hpcnow.com)
# Copyright::   HPCNow!
# Authors::     Jonney Huang <jonney.huang@hpcnow.com>
# License::     GPL-v3.0
# #

easyblock = 'CMakeMake'

name = 'ImpalaJIT'
local_commit_id = '0e4178b7245357a394717cb29f9183b93bafd62f'
version = '29102021'

homepage = 'https://github.com/uphoffc/ImpalaJIT'
description = """A lightweight JIT compiler for flexible data access in simulation applications
"""

toolchain = {'name': 'foss', 'version': '2023a'}
sources = [{
    'git_config': {
        'url': 'https://github.com/uphoffc/',
        'repo_name': 'ImpalaJIT',
        'commit': local_commit_id,
        'recursive': True,
        'keep_git_dir': True,
    },
    'filename': SOURCE_TAR_GZ,
}]

checksums = [None]

builddependencies = [
    ('CMake', '3.26.3'),
    ('pkg-config', '0.29.2'),
]

preconfigopts = "mkdir build && cd build && "

prebuildopts = 'cd build && '
preinstallopts = 'cd build && '
sanity_check_paths = {
    'files': ['lib64/libimpalajit.a'],
    'dirs': [],
}

moduleclass = 'geo'
