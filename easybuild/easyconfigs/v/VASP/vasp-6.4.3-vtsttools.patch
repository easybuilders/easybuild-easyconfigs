--- src/main.F.orig	2025-01-08 10:39:46.000000000 -0800
+++ src/main.F	2025-01-08 10:41:28.000000000 -0800
@@ -963,7 +963,7 @@
 ! init all chains (INCAR reader)
 !-----------------------------------------------------------------------
       LCHAIN = IMAGES > 0 .AND. .NOT.AFQMC_SET % ACTIVE
-      IF (LCHAIN) CALL chain_init( T_INFO, IO)
+      CALL chain_init( T_INFO, IO)
 !-----------------------------------------------------------------------
 !xml finish copying parameters from INCAR to xml file
 ! no INCAR reading from here
@@ -3699,7 +3699,7 @@
          CALL CHAIN_STRESS( TSIF )
       END IF
       CALL CHAIN_FORCE(T_INFO%NIONS,DYN%POSION,TOTEN,TIFOR, &
-           LATT_CUR%A,LATT_CUR%B,IO%IU6)
+           TSIF,LATT_CUR%A,LATT_CUR%B,IO%IU6)
 
       CALL PARALLEL_TEMPERING(NSTEP,T_INFO%NIONS,DYN%POSION,DYN%VEL,TOTEN,TIFOR,DYN%TEBEG,DYN%TEEND, &
            LATT_CUR%A,LATT_CUR%B,IO%IU6)
--- src/makefile.orig	2025-01-08 10:43:49.000000000 -0800
+++ src/makefile	2025-01-08 10:44:30.000000000 -0800
@@ -16,7 +16,7 @@
 OFLAG=$(OFLAG_2)
 OFLAG_IN=$(OFLAG)
 
-LIB=lib parser
+LIB=lib parser pyamff_fortran
 LLIB=-Llib -ldmy -Lparser -lparser
 
 SRCDIR=../../src
@@ -150,7 +150,7 @@
 	$(MAKE) -C $@ -j1
 #	$(MAKE) -C $@
 
-dependencies: sources
+dependencies: sources libs
 	$(MAKE) depend
 
 depend: $(F90SRC)
--- src/.objects.orig	2025-01-08 10:45:18.000000000 -0800
+++ src/.objects	2025-01-08 10:47:03.000000000 -0800
@@ -127,6 +127,20 @@
 	dos.o \
 	elf.o \
 	hamil_rot.o \
+	bfgs.o \
+	dynmat.o \
+	instanton.o \
+	lbfgs.o \
+	sd.o \
+	cg.o \
+	dimer.o \
+	bbm.o \
+	fire.o \
+	lanczos.o \
+	neb.o qm.o \
+	pyamff_fortran/*.o \
+	ml_pyamff.o \
+	opt.o \
 	chain.o \
 	dyna.o \
 	fileio.o \
