easyblock = 'ConfigureMake'

name = 'Vala'
version = '0.56.18'

homepage = 'https://wiki.gnome.org/Projects/Vala'
description = """Vala is a programming language using modern high level abstractions without imposing additional runtime
requirements and without using a different ABI compared to applications and libraries written in C."""

toolchain = {'name': 'GCCcore', 'version': '14.2.0'}

source_urls = ['http://download.gnome.org/sources/vala/%(version_major_minor)s/']
sources = [SOURCELOWER_TAR_XZ]
checksums = ['f2affe7d40ab63db8e7b9ecc3f6bdc9c2fc7e3134c84ff2d795f482fe926a382']

builddependencies = [
    ('binutils', '2.42'),
    ('pkgconf', '2.3.0'),
    ('flex', '2.6.4'),
    ('Bison', '3.8.2'),
    ('Graphviz', '13.1.2', '-minimal'),
]

dependencies = [
    ('GLib', '2.85.1'),
]

preconfigopts = 'GI_GIRDIR=gir CFLAGS="$CFLAGS -Wno-discarded-qualifiers" '

sanity_check_paths = {
    'files': ['bin/vala', 'bin/valac', 'bin/valadoc', 'lib/libvala-%%(version_major_minor)s.%s' % SHLIB_EXT,
              'lib/libvaladoc-%%(version_major_minor)s.%s' % SHLIB_EXT],
    'dirs': ['include/vala-%(version_major_minor)s'],
}

sanity_check_commands = [
    "vala --help",
    "valac --help",
    "valadoc --help",
]

moduleclass = 'lang'
