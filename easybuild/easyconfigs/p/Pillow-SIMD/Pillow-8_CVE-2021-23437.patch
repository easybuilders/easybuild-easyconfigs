Fix for CVE-2021-23437
author: Hugo van Kemenade (Nord Software)
diff -rupN --no-dereference Pillow-8.1.2/src/PIL/ImageColor.py Pillow-8.1.2-new/src/PIL/ImageColor.py
--- a/src/PIL/ImageColor.py	2021-03-06 03:38:55.000000000 +0100
+++ b/src/PIL/ImageColor.py	2021-09-13 08:39:22.289084217 +0200
@@ -32,6 +32,8 @@ def getrgb(color):
     :param color: A color string
     :return: ``(red, green, blue[, alpha])``
     """
+    if len(color) > 100:
+        raise ValueError("color specifier is too long")
     color = color.lower()
 
     rgb = colormap.get(color, None)
diff -rupN --no-dereference Pillow-8.1.2/Tests/test_imagecolor.py Pillow-8.1.2-new/Tests/test_imagecolor.py
--- a/Tests/test_imagecolor.py	2021-03-06 03:38:55.000000000 +0100
+++ b/Tests/test_imagecolor.py	2021-09-13 08:39:22.289084217 +0200
@@ -191,3 +191,12 @@ def test_rounding_errors():
     assert (255, 255) == ImageColor.getcolor("white", "LA")
     assert (163, 33) == ImageColor.getcolor("rgba(0, 255, 115, 33)", "LA")
     Image.new("LA", (1, 1), "white")
+
+
+def test_color_too_long():
+    # Arrange
+    color_too_long = "hsl(" + "1" * 100 + ")"
+
+    # Act / Assert
+    with pytest.raises(ValueError):
+        ImageColor.getrgb(color_too_long)
