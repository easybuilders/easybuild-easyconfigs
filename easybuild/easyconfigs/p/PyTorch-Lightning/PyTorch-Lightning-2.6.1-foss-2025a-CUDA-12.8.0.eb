easyblock = 'PythonBundle'

name = 'PyTorch-Lightning'
version = '2.6.1'
versionsuffix = '-CUDA-%(cudaver)s'

homepage = 'https://pytorchlightning.ai'
description = "PyTorch Lightning is the lightweight PyTorch wrapper for ML researchers."

toolchain = {'name': 'foss', 'version': '2025a'}

builddependencies = [
    ('setuptools', '80.9.0'),
    ('hatchling', '1.27.0'),
]

dependencies = [
    ('Python', '3.13.1'),
    ('CUDA', '12.8.0', '', SYSTEM),
    # dependencies from requirements/pytorch/base.txt
    ('PyTorch', '2.9.1', f'{versionsuffix}-whl'),
    ('tqdm', '4.67.1'),
    ('PyYAML', '6.0.2'),
    ('typing-extensions', '4.14.0'),
    # optional dependencies from requirements/pytorch/extra.txt
    ('bitsandbytes', '0.49.2', versionsuffix),
    ('tensorboardX', '2.6.4'),
    ('matplotlib', '3.10.3'),
    ('Hydra', '1.3.2', '-with-plugins'),
]

exts_list = [
    ('docstring-parser', '0.17.0', {  # Needed by jsonargparse[signatures]
        'checksums': ['583de4a309722b3315439bb31d64ba3eebada841f2e2cee23b99df001434c912'],
    }),
    ('typeshed-client', '2.8.2', {  # Needed by jsonargparse[signatures]
        'checksums': ['9d8e29fb74574d87bf9a719f77131dc40f2aeea20e97d25d4a3dc2cc30debd31'],
    }),
    ('jsonargparse', '4.46.0', {  # typing-extensions extra needed by signatures
        'use_pip_extras': 'typing-extensions,signatures,jsonnet',
        'checksums': ['4c331448841fea9cb2b41bf99adbea70a63f82cac516f2f13030378b3d93c329'],
    }),
    ('lightning-utilities', '0.15.2', {
        'source_tmpl': 'lightning_utilities-%(version)s.tar.gz',
        'checksums': ['cdf12f530214a63dacefd713f180d1ecf5d165338101617b4742e8f22c032e24'],
    }),
    ('torchmetrics', '1.8.2', {
        'checksums': ['cf64a901036bf107f17a524009eea7781c9c5315d130713aeca5747a686fe7a5'],
    }),
    ('pytorch-lightning', version, {
        'source_tmpl': 'pytorch_lightning-%(version)s.tar.gz',
        'checksums': ['ba08f8901cf226fcca473046ad9346f414e99117762dc869c76e650d5b3d7bdc'],
    }),
]

moduleclass = 'ai'
