easyblock = 'CMakePythonPackage'

name = 'pivy'
version = '0.6.9.a0'

homepage = 'https://coin3d.github.io'
description = '''Python binding for Coin.'''

toolchain = {'name': 'GCC', 'version': '13.2.0'}

source_urls = ['https://github.com/coin3d/%(name)s/archive/refs/tags/']
sources = ['%(version)s.tar.gz']
patches = [
    'pivy-0.6.9.a0-coin-includes.patch',
    'pivy-0.6.9.a0-swigify.patch',
    'pivy-0.6.9.a0-python-sitearch.patch',
]
checksums = [
    {'0.6.9.a0.tar.gz': '2c2da80ae216fe06394562f4a8fc081179d678f20bf6f8ec412cda470d7eeb91'},
    {'pivy-0.6.9.a0-coin-includes.patch': 'ac720c8d3c9f540217c3135651d74bbdfe2872d3b83d45020da361be8cd25bd7'},
    {'pivy-0.6.9.a0-swigify.patch': 'b8fe796d4a56ef0f3ad7a2dd64990d4efd84758d962fc9c98d1f256e55a0612d'},
    {'pivy-0.6.9.a0-python-sitearch.patch': '764a79ce69a270b6c41ff935f369a850e9988716785ee1007d6695dc35fce7b4'},
]

builddependencies = [
    ('CMake', '3.27.6'),
]

dependencies = [
    ('Python', '3.11.5'),
    ('SWIG', '4.1.1'),
    ('SoQt', '1.6.2'),
]

configopts = ' '.join([
    '-DPIVY_USE_QT6=ON',
    '-DPython_EXECUTABLE="${EBROOTPYTHON}/bin/python"',
    '-DPIVY_Python_SITEARCH="%(installdir)s/lib/python%(pyshortver)s/site-packages"',
    '-DDISABLE_SWIG_WARNINGS=ON',
    '-DCMAKE_VERBOSE_MAKEFILE=ON',
])

sanity_check_paths = {
    'files': [
        'lib/python%(pyshortver)s/site-packages/%(name)s/coin.py',
        'lib/python%(pyshortver)s/site-packages/%(name)s/_coin.so',
    ],
    'dirs': ['lib/python%(pyshortver)s/site-packages/%(name)s'],
}
sanity_check_commands = [
    "python -c 'from pivy import coin; va = coin.SbVec3f([0, 0, 0]);'"
]

moduleclass = 'vis'
