From 1181a2dfc04523e0263819846d4c5bd2bb9cd5ce Mon Sep 17 00:00:00 2001
From: Viktor Rehnberg <viktor.rehnberg@gmail.com>
Date: Fri, 1 Nov 2024 14:56:59 +0000
Subject: [PATCH] Squeeze channel dimension for 1 channel images

---
 tests/pulsar/test_forward.py | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)

diff --git a/tests/pulsar/test_forward.py b/tests/pulsar/test_forward.py
index da79028..d8cddbf 100644
--- a/tests/pulsar/test_forward.py
+++ b/tests/pulsar/test_forward.py
@@ -76,7 +76,7 @@ class TestForward(unittest.TestCase):
                         "test_out",
                         "test_forward_TestForward_test_bg_weight_hits.png",
                     ),
-                    (hits * 255.0).cpu().to(torch.uint8).numpy(),
+                    (hits * 255.0).cpu().to(torch.uint8).squeeze(2).numpy(),
                 )
             self.assertEqual(hits[500, 500, 0].item(), 1.0)
             self.assertTrue(
@@ -139,7 +139,7 @@ class TestForward(unittest.TestCase):
                         "test_out",
                         "test_forward_TestForward_test_basic_3chan_hits.png",
                     ),
-                    (hits * 255.0).cpu().to(torch.uint8).numpy(),
+                    (hits * 255.0).cpu().to(torch.uint8).squeeze(2).numpy(),
                 )
             self.assertEqual(hits[500, 500, 0].item(), 1.0)
             self.assertTrue(
@@ -194,7 +194,7 @@ class TestForward(unittest.TestCase):
                         "test_out",
                         "test_forward_TestForward_test_basic_1chan.png",
                     ),
-                    (result * 255.0).cpu().to(torch.uint8).numpy(),
+                    (result * 255.0).cpu().to(torch.uint8).squeeze(2).numpy(),
                 )
                 imageio.imsave(
                     path.join(
@@ -202,7 +202,7 @@ class TestForward(unittest.TestCase):
                         "test_out",
                         "test_forward_TestForward_test_basic_1chan_hits.png",
                     ),
-                    (hits * 255.0).cpu().to(torch.uint8).numpy(),
+                    (hits * 255.0).cpu().to(torch.uint8).squeeze(2).numpy(),
                 )
             self.assertEqual(hits[500, 500, 0].item(), 1.0)
             self.assertTrue(
@@ -264,7 +264,7 @@ class TestForward(unittest.TestCase):
                         "test_out",
                         "test_forward_TestForward_test_basic_8chan_hits.png",
                     ),
-                    (hits * 255.0).cpu().to(torch.uint8).numpy(),
+                    (hits * 255.0).cpu().to(torch.uint8).squeeze(2).numpy(),
                 )
             self.assertEqual(hits[500, 500, 0].item(), 1.0)
             self.assertTrue(
-- 
2.39.3

