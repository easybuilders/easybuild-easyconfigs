easyblock = 'PythonBundle'

name = 'pymatgen'
version = '2025.6.14'

homepage = 'https://pymatgen.org/'
description = """Python Materials Genomics is a robust materials analysis code that defines core object
 representations for structures and molecules with support for many electronic structure codes."""

toolchain = {'name': 'foss', 'version': '2024a'}

builddependencies = [
    ('hatchling', '1.24.2'),
    ('hypothesis', '6.103.1'),  # required for tests
    ('poetry', '1.8.3'),
    ('Cython', '3.0.10'),
    ('PDM', '2.18.2'),
]

dependencies = [
    ('Python', '3.12.3'),
    ('PyYAML', '6.0.2'),
    ('PyZMQ', '26.2.0'),
    ('bcrypt', '4.3.0'),
    ('boto3', '1.35.36'),
    ('Flask', '3.0.3'),
    ('matplotlib', '3.9.2'),
    ('networkx', '3.4.2'),
    ('paramiko', '3.5.1'),
    ('plotly.py', '5.24.1'),
    ('pydantic', '2.9.1'),
    ('ruamel.yaml', '0.18.6'),
    ('spglib-python', '2.5.0'),
    ('sympy', '1.13.3'),
    ('tqdm', '4.66.5'),
    ('uncertainties', '3.2.3'),
    ('orjson', '3.10.13'),
]

exts_list = [
    ('palettable', '3.3.3', {
        'checksums': ['094dd7d9a5fc1cca4854773e5c1fc6a315b33bd5b3a8f47064928facaf0490a8'],
    }),
    ('latexcodec', '3.0.1', {
        'checksums': ['e78a6911cd72f9dec35031c6ec23584de6842bfbc4610a9678868d14cdfb0357'],
    }),
    ('pybtex', '0.25.1', {
        'checksums': ['9eaf90267c7e83e225af89fea65c370afbf65f458220d3946a9e3049e1eca491'],
    }),
    ('h11', '0.14.0', {
        'checksums': ['8f19fbbe99e72420ff35c00b27a34cb9937e902a8b810e2c88300c6f0a3b699d'],
    }),
    ('uvicorn', '0.35.0', {
        'checksums': ['bc662f087f7cf2ce11a1d7fd70b90c9f98ef2e2831556dd078d131b96cc94a01'],
    }),
    ('sshtunnel', '0.4.0', {
        'checksums': ['e7cb0ea774db81bf91844db22de72a40aae8f7b0f9bb9ba0f666d474ef6bf9fc'],
    }),
    ('dnspython', '2.7.0', {
        'modulename': False,
        'checksums': ['ce9c432eda0dc91cf618a5cedf1a4e142651196bbcd2c80e89ed5a907e5cfaf1'],
    }),
    ('pymongo', '4.10.1', {
        'checksums': ['a9de02be53b6bb98efe0b9eda84ffa1ec027fcb23a2de62c4f941d9a2f2f3330'],
    }),
    ('pydash', '8.0.5', {
        'checksums': ['7cc44ebfe5d362f4f5f06c74c8684143c5ac481376b059ff02570705523f9e2e'],
    }),
    ('python-dotenv', '1.1.1', {
        'modulename': 'dotenv',
        'sources': ['python_dotenv-%(version)s.tar.gz'],
        'checksums': ['a8a6399716257f45be6a007360200409fce5cda2661e3dec71d23dc15f6189ab'],
    }),
    ('typing_extensions', '4.12.0', {
        'checksums': ['8cbcdc8606ebcb0d95453ad7dc5065e6237b6aa230a31e81d0f440c30fed5fd8'],
    }),
    ('typing_inspection', '0.4.1', {
        # Use wheel as source to avoid "TypeError: Field `project.license-files` must be a table"
        'source_tmpl': SOURCE_PY3_WHL,
        'checksums': ['389055682238f53b04f7badcb49b989835495a96700ced5dab2d8feae4b26f51'],
    }),
    ('pydantic-settings', '2.10.1', {
        'sources': {
            'source_urls': ['https://github.com/pydantic/pydantic-settings/archive/refs/tags/'],
            'download_filename': '%(version)s.tar.gz',
            'filename': '%(name)s-%(version)s.tar.gz',
        },
        'checksums': ['7cd8614d20b7ace259c99c9abd4b618a2213dc98cc6500834303acdc6e9ce1d2'],
    }),
    ('pymatgen_io_validation', '0.1.2', {
        'modulename': 'pymatgen.io.validation',
        'preinstallopts': "sed -i 's/0.1.0rc/%(version)s/' setup.py && ",
        'checksums': ['76632878ab2269356092dab5bae08c8f42418c3e15d4610f4eb304f0102e7f24'],
    }),
    ('emmet-core', '0.84.10', {
        'modulename': 'emmet',
        'sources': ['emmet_core-%(version)s.tar.gz'],
        'checksums': ['7da3ec4cd6aa6c9bdc5a1b6cd484c36284416311c29226776124fd2fb228fba7'],
    }),
    ('monty', '2025.3.3', {
        'checksums': ['16c1eb54b2372e765c2f3f14cff01cc76ab55c3cc12b27d49962fb8072310ae0'],
    }),
    ('sentinels', '1.0.0', {
        'checksums': ['7be0704d7fe1925e397e92d18669ace2f619c92b5d4eb21a89f31e026f9ff4b1'],
    }),
    ('mongomock', '4.3.0', {
        'checksums': ['32667b79066fabc12d4f17f16a8fd7361b5f4435208b3ba32c226e52212a8c30'],
    }),
    ('mongogrant', '0.3.3', {
        'checksums': ['ad494b8638adfa840cdd5568af44448dd43771b58102550cf7c61402b1620ab4'],
    }),
    ('sniffio', '1.3.1', {
        'checksums': ['f4324edc670a0f49750a81b895f35c3adb843cca46f0530f79fc1babb23789dc'],
    }),
    ('anyio', '4.9.0', {
        'checksums': ['673c0c244e15788651a4ff38710fea9675823028a6f08a5eda409e0c9840a028'],
    }),
    ('starlette', '0.47.1', {
        'checksums': ['aef012dd2b6be325ffa16698f9dc533614fb1cebd593a906b90dc1025529a79b'],
    }),
    ('fastapi', '0.116.1', {
        'checksums': ['ed52cbf946abfd70c5a0dccb24673f0670deeb517a88b3544d03c2a6bf283143'],
    }),
    ('aioitertools', '0.12.0', {
        'checksums': ['c2a9055b4fbb7705f561b9d86053e8af5d10cc845d22c32008c43490b2d8dd6b'],
    }),
    ('jsonlines', '4.0.0', {
        'checksums': ['0c6d2c09117550c089995247f605ae4cf77dd1533041d366351f6f298822ea74'],
    }),
    ('maggma', '0.71.5', {
        'checksums': ['5f14c13a512ee59fc7fa2ae714dc70a86b2fa7a02355cfe58a5d089466216419'],
    }),
    ('wrapt', '1.17.2', {
        'checksums': ['41388e9d4d1522446fe79d3213196bd9e3b301a336965b9e27ca2788ebd122f3'],
    }),
    ('smart-open', '7.3.0.post1', {
        'sources': ['smart_open-%(version)s.tar.gz'],
        'checksums': ['ce6a3d9bc1afbf6234ad13c010b77f8cd36d24636811e3c52c3b5160f5214d1e'],
    }),
    ('mp-api', '0.45.12', {
        'sources': ['mp_api-%(version)s.tar.gz'],
        'checksums': ['b79fe99b25b097df8d56a1ba4189cdf6f1879813d766580760365e0666128c9e'],
    }),
    ('bibtexparser', '1.4.3', {
        'checksums': ['a9c7ded64bc137720e4df0b1b7f12734edc1361185f1c9097048ff7c35af2b8f'],
    }),
    (name, version, {
        'source_tmpl': 'v%(version)s.tar.gz',
        'source_urls': ['https://github.com/materialsproject/pymatgen/archive/refs/tags'],
        'checksums': ['5fb34d91889816240e93888a64bdf0b8d17ae23c51b9f6f9dcd5c940a90f47a6'],
    }),
]

sanity_check_paths = {
    'files': ['bin/pmg'],
    'dirs': ['lib/python%(pyshortver)s/site-packages'],
}

sanity_check_commands = ["pmg --help"]

moduleclass = 'chem'
