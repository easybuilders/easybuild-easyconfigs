# Author: Pavel Grochal (INUITS)
# License: GPLv2
# Update: Petr KrÃ¡l (INUITS)

easyblock = 'PythonBundle'

name = 'PyBerny'
version = '0.6.3'

homepage = 'https://github.com/jhrmnn/pyberny'
description = """PyBerny is an optimizer of molecular geometries with respect to the total energy,
using nuclear gradient information."""

toolchain = {'name': 'foss', 'version': '2025a'}

builddependencies = [
    ('poetry', '2.1.2'),
]

dependencies = [
    ('Python', '3.13.1'),
    ('SciPy-bundle', '2025.06'),
]

exts_list = [
    ('pyberny', version, {
        'modulename': 'berny',
        # Allow numpy major version 2
        'preinstallopts': """sed -i 's/numpy = "^1.15"/numpy = ">1.15"/' pyproject.toml && """,
        'checksums': ['b4bd9d3d2d58261e8f1d91b8204cc563617044d4b9daf6aae8feee31893cb336'],
    }),
]

sanity_check_paths = {
    'files': ['bin/berny'],
    'dirs': ['lib/python%(pyshortver)s/site-packages'],
}

sanity_check_commands = ["berny -h"]

moduleclass = 'chem'
