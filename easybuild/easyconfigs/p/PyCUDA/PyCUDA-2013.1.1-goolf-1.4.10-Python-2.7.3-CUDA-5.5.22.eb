##
# This file is an EasyBuild reciPY as per https://github.com/hpcugent/easybuild
#
# Copyright:: Copyright 2012-2015 Uni.Lu/LCSB, NTUA
# Authors::   Fotis Georgatos <fotis@cern.ch>
# License::   MIT/GPL
# $Id$
#
# This work implements a part of the HPCBIOS project and is a component of the policy:
# http://hpcbios.readthedocs.org/en/latest/HPCBIOS_2012-99.html
##

easyblock = "PythonPackage"

name = "PyCUDA"
version = "2013.1.1"

homepage = "https://pypi.python.org/pypi/pycuda"
description = """Python wrapper for Nvidia CUDA.
 PyCUDA lets you access Nvidia's CUDA parallel computation API from Python."""

toolchain = {'name': 'goolf', 'version': '1.4.10'}

##sources = [SOURCELOWER_ZIP]
sources = [SOURCELOWER_TAR_GZ]
source_urls = [PYPI_LOWER_SOURCE]

##checksums = [[
##    ('md5', 'b67c4fce6c258834339073f2537fa84f'),
##    ('sha1', 'dd52ee697ae9f6256efac3bca682be9c6e7c9649'),
##    ('size', 1473695),
##]]

python = "Python"
pythonversion = "2.7.3"
pysuffix = versionsuffix = "-%s-%s" % (python, pythonversion)

cuda = "CUDA"
cudaversion = "5.5.22"
versionsuffix += "-%s-%s" % (cuda, cudaversion)

##boostver = '1.51.0' ## annoying Boost dependency?

dependencies = [
##    ('Boost', boostver, '-Python-%s' % pythonversion),
    (python, pythonversion),
    (cuda, cudaversion, '', True),
    ('setuptools', '0.6c11', pysuffix),
]

prebuildopts = 'python configure.py --cuda-root=$EBROOTCUDA && '

py_short_ver = ".".join(pythonversion.split(".")[0:2])
pylibdir = "lib/python%s/site-packages/%s" % (py_short_ver, name.lower())

sanity_check_paths = {
    'files': [],
    'dirs': ["%s-%s-py%s-linux-x86_64.egg" % (pylibdir, version, py_short_ver)]
}

moduleclass = 'devel'
