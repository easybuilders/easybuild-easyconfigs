easyblock = "Binary"

name = "pbtk"
version = "3.1.0"

homepage = "https://github.com/PacificBiosciences/$(name)s"
description = """pb replacement of pbbam """

toolchain = SYSTEM

source_urls = ["https://github.com/PacificBiosciences/pbtk"]
sources = ["releases/download/v%(version)s/%(name)s.tar.gz"]
checksums = ['00d03f07071c1926282fe9de460ed9f505fe4caf5691ffd5df6a422ab5a2fc81']

extract_sources = True

postinstallcmds = ["find %(installdir)s -type f -exec chmod +x {} \;"]

sanity_check_paths = {
    "files": [
        "bam2fasta",
        "bam2fastq",
        "ccs-kinetics-bystrandify",
        "extracthifi",
        "pbindex",
        "pbindexdump",
        "pbmerge",
        "zmwfilter",
    ],
    "dirs": [""],
}

moduleclass = "bio"

buildstats = [
    {
        "build_time": 6.07,
        "command_line": [
            "--add-system-to-minimal-toolchains",
            "--buildpath='/dev/shm'",
            "--configfiles='/cluster/easybuild/config.cfg'",
            "--containerpath='/cluster/easybuild/containers'",
            "--filter-deps='adwaita-icon-theme,Autoconf,Autogen,Automake,Autotools,babl,binutils,Bison,byacc,bzip2,cairo,Coreutils,cURL,DBus,dbus-glib,Doxygen,Dyninst,Exiv2,expat,flex,FLTK,fontconfig,fontsproto,freeglut,freetype,FTGL,glibc,gc,Gdk-Pixbuf,GEGL,gettext,gexiv2,Ghostscript,GL2PS,GLEW,GLPK,glproto,GMP,GObject-Introspection,GPC,gperfguile,GraphicsMagick,gsettings-desktop-schemas,GTI,GTK+,GtkSourceView,GTS,Guile,HarfBuzz,help2man,inputproto,intltool,itstool,jhbuild,kbproto,libcroco,libctl,libdap,libdrm,libdwarf,libelf,libepoxy,libffi,libfontenc,libgeotiff,libglade,libGLU,libICE,libidn,Libint,libmypaint,libpciaccess,libpthread-stubs,libreadline,librsvg,libSM,libunistring,libunwind,LibUUID,libX11,libXau,libXaw,libxml2,libxcb,libXcursor,libXdamage,libXdmcp,libXext,libXfixes,libXfont,libXft,libXi,libXinerama,libxkbcommon,libXmu,libXpm,libXrandr,libXrender,libxslt,libXt,libXtst,libyaml,LittleCMS,M4,makedepend,Mesa,motif,ncurses,nettle,numactl,nvidia,PCRE,PDT,pixman,pkgconfig,pkg-config,popt,pscom,PyCairo,PyGObject,qt,Qt,Qt5,randrproto,recordproto,renderproto,S-Lang,texinfo,Tk,util-linux,wget,wxPropertyGrid,xbitmaps,xcb-proto,xcb-util,xcb-util-image,xcb-util-keysyms,xcb-util-renderutil,xcb-util-wm,xextproto,xineramaproto,X11,XKeyboardConfig,XML-Parser,xorg-macros,Xvfb,XZ,Yasm,YAXT,zlib,Tcl,Pango'",
            "--force",
            "--group-writable-installdir",
            "--hide-deps='x264,x265,LAME,g2lib,g2clib,libmatheval,LibTIFF,OpenJPEG,libjpeg-turbo,libpng,Tcl,libtool'",
            "--include-easyblocks='/cluster/easybuild/customeasyblocks/*.py'",
            "--installpath='/cluster/easybuild'",
            "--minimal-build-env='CC:gcc,CXX:g++,CFLAGS:-march=core-avx2'",
            "--minimal-toolchains",
            "--module-naming-scheme='CategorizedModuleNamingScheme'",
            "--module-syntax='Tcl'",
            "--optarch='{\\'GCC\\': \\'march=broadwell -mtune=broadwell\\', \\'dummy\\': \\'march=core-avx2\\', \\'Intel\\': \\'xCORE-AVX2\\', \\'PGI\\': \\'tp=haswell\\'}'",
            "--packagepath='/cluster/easybuild/packages'",
            "--parallel='40'",
            "--prefix='/cluster/easybuild'",
            "--read-only-installdir",
            "--repository='GitRepository'",
            "--repositorypath='/cluster/easybuild/broadwell/easyconfigs_broadwell.git'",
            "--robot-paths='/cluster/easybuild/broadwell/easyconfigs_broadwell:'",
            "--set-gid-bit",
            "--sourcepath='/cluster/easybuild/sources'",
            "--subdir-modules='broadwell/modules'",
            "--subdir-software='broadwell/software'",
            "--tmpdir='/cluster/easybuild/tmp'",
            "--umask='002'",
            "pbtk.eb",
        ],
        "core_count": 40,
        "cpu_arch": "x86_64",
        "cpu_arch_name": "UNKNOWN",
        "cpu_model": "Intel(R) Xeon(R) CPU E5-2630 v4 @ 2.20GHz",
        "cpu_speed": 3100.0,
        "cpu_vendor": "Intel",
        "easybuild-easyblocks_version": "4.7.1",
        "easybuild-framework_version": "4.7.1",
        "gcc_version": "Using built-in specs.; COLLECT_GCC=gcc; COLLECT_LTO_WRAPPER=/usr/libexec/gcc/x86_64-redhat-linux/8/lto-wrapper; OFFLOAD_TARGET_NAMES=nvptx-none; OFFLOAD_TARGET_DEFAULT=1; Target: x86_64-redhat-linux; Configured with: ../configure --enable-bootstrap --enable-languages=c,c++,fortran,lto --prefix=/usr --mandir=/usr/share/man --infodir=/usr/share/info --with-bugurl=http://bugs.almalinux.org/ --enable-shared --enable-threads=posix --enable-checking=release --enable-multilib --with-system-zlib --enable-__cxa_atexit --disable-libunwind-exceptions --enable-gnu-unique-object --enable-linker-build-id --with-gcc-major-version-only --with-linker-hash-style=gnu --enable-plugin --enable-initfini-array --with-isl --disable-libmpx --enable-offload-targets=nvptx-none --without-cuda-driver --enable-gnu-indirect-function --enable-cet --with-tune=generic --with-arch_32=x86-64 --build=x86_64-redhat-linux; Thread model: posix; gcc version 8.5.0 20210514 (Red Hat 8.5.0-4) (GCC) ; ",
        "glibc_version": "2.28",
        "hostname": "login22.mogon",
        "install_size": 18397843,
        "modules_tool": ("Lmod", "/cluster/modules/lmod/8.4/libexec/lmod", "8.4"),
        "os_name": "AlmaLinux",
        "os_type": "Linux",
        "os_version": "8.5",
        "platform_name": "x86_64-unknown-linux",
        "python_version": "3.6.8 (default, Nov 17 2021, 16:10:06) ; [GCC 8.5.0 20210514 (Red Hat 8.5.0-3)]",
        "system_gcc_path": "/usr/bin/gcc",
        "system_python_path": "/cluster/easybuild/broadwell/software/Python/3.10.4-GCCcore-11.2.0/bin/python",
        "timestamp": 1681389994,
        "total_memory": 128546,
    }
]
