Fix for CVE-2021-23437
author: Hugo van Kemenade (Nord Software)
--- a/src/PIL/ImageColor.py	2020-01-02 09:31:35.000000000 +0100
+++ b/src/PIL/ImageColor.py	2022-01-18 16:42:11.359922625 +0100
@@ -32,6 +32,8 @@
     :param color: A color string
     :return: ``(red, green, blue[, alpha])``
     """
+    if len(color) > 100:
+        raise ValueError("color specifier is too long")
     color = color.lower()
 
     rgb = colormap.get(color, None)
--- a/Tests/test_imagecolor.py	2022-01-18 16:42:11.362700436 +0100
+++ b/Tests/test_imagecolor.py	2022-01-18 17:43:53.880517448 +0100
@@ -182,3 +182,11 @@
         self.assertEqual((255, 255), ImageColor.getcolor("white", "LA"))
         self.assertEqual((163, 33), ImageColor.getcolor("rgba(0, 255, 115, 33)", "LA"))
         Image.new("LA", (1, 1), "white")
+
+def test_color_too_long():
+    # Arrange
+    color_too_long = "hsl(" + "1" * 100 + ")"
+
+    # Act / Assert
+    with pytest.raises(ValueError):
+        ImageColor.getrgb(color_too_long)
