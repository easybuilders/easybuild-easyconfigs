easyblock = 'ConfigureMake'

name = 'Proteinortho'
version = '6.3.4'

homepage = 'https://www.bioinf.uni-leipzig.de/Software/proteinortho'
description = "Proteinortho is a tool to detect orthologous genes within different species."

toolchain = {'name': 'foss', 'version': '2024a'}

source_urls = ['https://gitlab.com/paulklemm_PHD/proteinortho/-/archive/v%(version)s/']
sources = ['proteinortho-v%(version)s.tar.gz']
checksums = ['d38514e8d5a08cc99b0539348fff89a200325d46241af8ad13037ad57151c161']

dependencies = [
    ('Perl', '5.38.2'),
    ('Python', '3.12.3'),
    ('BLAST+', '2.16.0'),
    ('DIAMOND', '2.1.11'),
]

skipsteps = ['configure']

# run "make clean" first, otherwise we skip the compilation due to bundled artefacts
prebuildopts = "make clean && sed -i 's/-llapack -lblas/-lflexiblas/g' Makefile && "

preinstallopts = "mkdir -p %(installdir)s/bin && "
installopts = "PREFIX=%(installdir)s/bin"

sanity_check_paths = {
    'files': ['bin/proteinortho', 'bin/proteinortho%(version_major)s.pl', 'bin/proteinortho_clustering'],
    'dirs': [],
}

sanity_check_commands = ["proteinortho --help"]

moduleclass = 'bio'
