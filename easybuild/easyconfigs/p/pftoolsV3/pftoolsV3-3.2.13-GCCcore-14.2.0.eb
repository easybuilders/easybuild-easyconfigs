easyblock = 'CMakeMake'

name = 'pftoolsV3'
version = '3.2.13'

homepage = 'https://github.com/sib-swiss/pftools3'
description = """A suite of tools to build and search generalized profiles (protein and DNA)."""
software_license = 'LicenseGPLv2'

toolchain = {'name': 'GCCcore', 'version': '14.2.0'}

sources = ['v%(version)s.tar.gz']
source_urls = ['https://github.com/sib-swiss/pftools3/archive/refs/tags/']
checksums = ['8ce94eee80e2801fa783574101efe2da8e094cd2353acb6655de9811237d6b95']  # pftools3-3.2.13.tar.gz

builddependencies = [
    ('binutils', '2.42'),
    ('CMake', '3.31.3'),
    ('make', '4.4.1'),
    ('pkgconf', '2.3.0'),
]

dependencies = [
    ('libgd', '2.3.3'),
    ('libharu', '2.4.5'),
    ('libjpeg-turbo', '3.1.0'),
    ('libpng', '1.6.48'),
    ('PCRE2', '10.45'),
    ('Perl', '5.40.0'),
    ('zlib', '1.3.1'),
]

configopts = '-DUSE_GRAPHICS=OFF -DUSE_PDF=ON -DUSE_AFFINITY=OFF'  # Disable affinity for some old architectures

runtest = 'test'

sanity_check_paths = {
    'files': [
        'bin/2ft',
        'bin/6ft',
        'bin/htop',
        'bin/pfdump',
        'bin/pfscan',
        'bin/pfscanV3',
        'bin/pfsearch',
        'bin/pfsearchV3',
        'bin/ptof',
    ],
    'dirs': [
        'share/doc',
        'share/man'
    ],
}

sanity_check_commands = [
    'pfscanV3 --help',
    'pfsearchV3 --help',
]

moduleclass = 'bio'
