# Ruoshi Sun <rs7wz@virginia.edu>
# Research Computing, University of Virginia
# 2020-05-24

easyblock = 'MakeCp'

name = 'ATAT'
version = '3.36'

homepage = 'https://www.brown.edu/Departments/Engineering/Labs/avdw/atat/'
description = """
The Alloy-Theoretic Automated Toolkit (ATAT) is a generic name that refers to a collection of alloy theory tools
"""

toolchain = {'name': 'GCCcore', 'version': '9.3.0'}

source_urls = ['http://alum.mit.edu/www/avdw/%(namelower)s']
sources = ['%%(namelower)s%s.tar.gz' % version.replace('.', '_')]
checksums = ['e829da5b714a012b5fc456d1060cfdb784642a8c0cbb702d409497b65466ee39']

builddependencies = [
    ('binutils', '2.34')
]

prebuildopts = 'export BINDIR=%(installdir)s/bin && mkdir -p $BINDIR && '

files_to_copy = ['./*']

postinstallcmds = [
    'export BINDIR=%(installdir)s/bin && ' +
    'cd %(installdir)s && ' +
    'make -C src BINDIR=$BINDIR install && ' +
    'make -C glue/jobctrl BINDIR=$BINDIR install && ' +
    'make -C glue/vasp BINDIR=$BINDIR install && make clean',
]

sanity_check_paths = {
    'files': ['bin/maps'],
    'dirs': ['bin', 'data'],
}

modloadmsg = "First-time users please run:\necho set atatdir=$EBROOTATAT > $HOME/.atat.rc\n"

moduleclass = 'chem'
