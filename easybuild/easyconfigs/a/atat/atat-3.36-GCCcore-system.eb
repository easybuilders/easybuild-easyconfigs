# Ruoshi Sun <rs7wz@virginia.edu>
# Research Computing, University of Virginia
# 2020-05-23

easyblock = 'MakeCp'

name = 'atat'
version = '3.36'

homepage = 'https://www.brown.edu/Departments/Engineering/Labs/avdw/atat/'
description = """The Alloy-Theoretic Automated Toolkit (ATAT) is a generic name that refers to a collection of alloy theory tools"""

toolchain = {'name': 'GCCcore', 'version': 'system'}

source_urls = ['http://alum.mit.edu/www/avdw/%(name)s']
sources = ['%%(name)s%s.tar.gz' % version.replace('.','_')]
checksums = ['31a6b38fb213175809559285bd7c93d0']

files_to_copy = ['./*']

# scripts to copy from glue/vasp to bin
local_vasp_scripts = 'ezvasp runstruct_vasp cleanvasp extract_vasp checkerr_vasp robustrelax_vasp' 

postinstallcmds = [
    'mkdir %(installdir)s/bin',
    'cd %(installdir)s/src && find -type f -executable -exec mv {} ../bin \; && cd .. && make clean',
    "cd %(installdir)s/glue/jobctrl && cp $(sed -n 's/ALLSCRIPT=//p' makefile) %(installdir)s/bin",
    'cd %%(installdir)s/glue/vasp && cp %s %%(installdir)s/bin' % local_vasp_scripts,
]

sanity_check_paths = {
    'files': ['bin/maps'],
    'dirs': ['bin', 'data'],
}

modloadmsg = "First-time users please run:\necho set atatdir=$EBROOTATAT > $HOME/.atat.rc\n"

moduleclass = 'chem'
