# This easyconfig was created by Simon Branford of the BEAR Software team at the University of Birmingham.
easyblock = 'CMakeMake'

name = 'Neper'
version = '3.4.0'

homepage = "http://neper.sourceforge.net/"
description = """Neper is a software package for polycrystal generation and meshing. It can deal with 2D and 3D
 polycrystals with very large numbers of grains."""

toolchain = {'name': 'foss', 'version': '2018b'}

source_urls = ['https://github.com/rquey/neper/archive/']
sources = ['%(version)s.tar.gz']
patches = ['%(name)s-%(version)s_fix_missing_file_in_tests.patch']
checksums = [
    'dd91c380fdedbdcdfb0eebd27dc057421a0fd3938958442c49c608029940e5ca',  # 3.4.0.tar.gz
    'a6fdffa761fe0ce29c93a96a11cc5e96cc2206bdcadd358838d8633cc5ec63f7',  # Neper-3.4.0_fix_missing_file_in_tests.patch
]

builddependencies = [('CMake', '3.12.1')]

dependencies = [
    ('GSL', '2.5'),
    ('NLopt', '2.4.2'),
    ('SCOTCH', '6.0.6'),
    ('gmsh', '4.2.2', '-Python-3.6.6'),
    ('POV-Ray', '3.7.0.7'),
    ('libpng', '1.6.34'),
]

start_dir = 'src'

configopts = ' -DHAVE_LIBSCOTCH=ON -DHAVE_PTHREAD=ON -DHAVE_PNG=ON'

runtest = 'test'

sanity_check_paths = {
    'files': ['bin/neper', 'lib/liborilib.a'],
    'dirs': ['include/orilib'],
}

sanity_check_commands = ['%(namelower)s -T -n 2']

moduleclass = 'chem'
